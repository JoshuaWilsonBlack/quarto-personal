<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PCA in Sociolinguistics: A Tutorial</title>
    <meta charset="utf-8" />
    <meta name="author" content="Joshua Wilson Black" />
    <meta name="date" content="2022-07-27" />
    <script src="libs/header-attrs-2.14/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
    <script src="libs/plotly-binding-4.10.0/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <script src="libs/jquery-3.5.1/jquery.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: top, title-slide

.title[
# PCA in Sociolinguistics: A Tutorial
]
.author[
### Joshua Wilson Black
]
.date[
### 27 July 2022
]

---




# Overview

1. What is PCA?
  
  1. A simple example in three dimensions
  2. A more general description
  
--

2. A Worked Example in R

  1. Preparing data
  2. Applying PCA with `prcomp`
  3. Interpreting PCA output (via `factoextra`)
    
--

3. When is PCA Appropriate?

  - Rules of thumb
  - Examples from linguistics literature

---

# PCA with Three Variables



<div id="htmlwidget-d4fce8a11e0309a80bab" style="width:100%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d4fce8a11e0309a80bab">{"x":{"visdat":{"2ca0273d6f73":["function () ","plotlyVisDat"],"2ca04c1837bc":["function () ","data"],"2ca060873526":["function () ","data"],"2ca07d7a5ff2":["function () ","data"]},"cur_data":"2ca07d7a5ff2","attrs":{"2ca0273d6f73":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":2,"opacity":1,"color":"gray","lines":{"color":"black","width":1},"showlegend":false},"hoverinfo":"text","text":{},"name":"Speakers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"2ca04c1837bc":{"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":6,"opacity":1,"color":"red","symbol":"x"},"name":"Center","visible":"legendonly","hoverinfo":"text","text":{},"inherit":false},"2ca060873526":{"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","name":"PC1","line":{"color":"#D55E00","width":6},"visible":"legendonly","hoverinfo":"text","text":{},"inherit":false},"2ca07d7a5ff2":{"x":{},"y":{},"z":{},"type":"scatter3d","mode":"lines","name":"PC2","line":{"color":"#0072B2","width":4},"visible":"legendonly","hoverinfo":"text","text":{},"inherit":false}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"DRESS F1 (Hz)"},"yaxis":{"title":"KIT F1 (Hz)"},"zaxis":{"title":"TRAP F1 (Hz)"}},"plot_bgcolor":"rgba(0, 0, 0, 0)","paper_bgcolor":"rgba(0, 0, 0, 0)","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[622.579710144928,551.328244274809,534.7,455.842592592593,515.780821917808,557.509090909091,605.103448275862,418.370967741935,472.489795918367,507.8,494.131782945736,494.136363636364,584.316455696203,409.094339622641,540.792792792793,586.945652173913,431.285714285714,581.792792792793,593.764705882353,482.757142857143,493.545454545455,500.822784810127,466.9,469.560975609756,497.817073170732,451.1953125,474.277777777778,562.180327868852,516.451612903226,451.746031746032,380.255102040816,541.180327868852,439.875675675676,386.638888888889,466.852813852814,483.666666666667,455.55737704918,521.055555555556,473.744791666667,433.594594594595,359.233333333333,530.811320754717,511.469696969697,502.785714285714,495.436170212766,419.898876404494,394.21875,364.922110552764,417.454183266932,516.900677200903,532.10298102981,609.527027027027,498.353233830846,476.789081885856,603.21875,467.718826405868,566.812,625.219512195122,444.050505050505,605.965517241379,492.824829931973,576.354207436399,458.576023391813,516.825757575758,563.711711711712,417.282352941176,522.19395465995,494.370689655172,451.587557603687,598.685897435897,418.041666666667,529.913279132791,495.264150943396,578.661417322835,549.831275720165,571.701923076923,427.940298507463,483.0125,454.181818181818,548.10298102981,480.024590163934,438.724637681159,484.086538461538,456.159090909091,609.904522613065,447.020648967552,515.421686746988,436.224137931034,538.978142076503,415.586206896552,421.976744186047,446.174603174603,517.931937172775,510.577272727273,474.578947368421,559,411.76397515528,489.34375,447.898734177215,460.881502890173],"y":[646.821428571429,622.243093922652,588.844444444444,525.055944055944,567.838235294118,634.794871794872,664.029411764706,495.585714285714,450.162162162162,631.923076923077,614.055363321799,566.150793650794,652,465.537313432836,619.81308411215,673.522222222222,547.716417910448,602.231481481482,656.721088435374,541.603448275862,541.462686567164,508.588607594937,469.65,485.915966386555,504.479166666667,481.496688741722,589.254237288136,559.666666666667,535.140495867769,464.553398058252,404.942148760331,539.363636363636,487.096096096096,391.292993630573,484.39263803681,504.872340425532,465.243902439024,555.49358974359,479.544378698225,489.714285714286,396.735294117647,532.84962406015,533.634146341463,520.9375,473.844380403458,391.284916201117,392.654362416107,457.011682242991,475.977198697068,484.6875,484.597014925373,535.667692307692,472.040152963671,490.629722921914,569.02380952381,447.387610619469,515.224880382775,547.833333333333,508.913894324853,557.962962962963,486.433644859813,549.147739801544,425.973262032086,456.404411764706,528.636170212766,414.662447257384,495.335784313725,460.624595469256,424.834470989761,485.341935483871,357.5,451.029082774049,443.645833333333,428.310344827586,439.171875,418.576923076923,367.556962025316,428.385321100917,393.042857142857,405.049261083744,366.227272727273,398.88679245283,394.958904109589,397.301204819277,452.443349753695,375.448924731183,395.257142857143,405.74025974026,405.891803278689,348.216216216216,354.048611111111,387.408163265306,430.47619047619,417.155688622754,388.514851485149,439.573333333333,338.172093023256,374.92349726776,382.222570532915,378.08764940239],"z":[637.866666666667,669.138461538462,629.565217391304,579.072727272727,623.690476190476,657.509433962264,662.3,486.361111111111,531.954545454545,668.382978723404,628.333333333333,565.703703703704,691.076923076923,551.625,624.695652173913,737.935483870968,583.28,678.53125,628.789473684211,570.851851851852,591.689655172414,604.142857142857,561.5625,616.137931034483,594.314285714286,485.58,621.372093023256,612.41935483871,576.227272727273,529.137931034483,496.686274509804,620.555555555556,546.521126760563,445.369230769231,588.223404255319,558.46511627907,523.621621621622,633.909090909091,521.675,546.395348837209,473.670731707317,588.766666666667,629.705882352941,647.411764705882,648.427027027027,558.290909090909,506.65873015873,493.552845528455,509.748201438849,613.405594405594,621.390070921986,694.872340425532,588.413580246914,607.461988304094,690.285714285714,593.839416058394,673.451219512195,692.537313432836,638.750915750916,712.351063829787,615.357142857143,727.369863013699,551.644444444444,615.16,613.19375,525.024590163934,620.151898734177,596.638461538462,517.59748427673,710.970149253731,455.25,645.690821256039,613.8,759.654545454545,703.384615384615,751.371428571429,475.763157894737,567.678571428571,526.692307692308,700.195,594.41935483871,531.014084507042,618.482142857143,527.965517241379,690.672566371681,475.413114754098,640.326086956522,492.352941176471,682.005235602094,491.789473684211,546.330769230769,504.695652173913,588.876470588235,587.354330708661,594.527272727273,645.457142857143,510.553459119497,600.642857142857,598.591240875912,618.434108527132],"mode":"markers","marker":{"color":"gray","size":2,"opacity":1,"lines":{"color":"black","width":1},"showlegend":false,"line":{"color":"black","width":1}},"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["DRESS: 623 (Hz)<br>KIT: 647 (Hz)<br>TRAP: 638 (Hz)","DRESS: 551 (Hz)<br>KIT: 622 (Hz)<br>TRAP: 669 (Hz)","DRESS: 535 (Hz)<br>KIT: 589 (Hz)<br>TRAP: 630 (Hz)","DRESS: 456 (Hz)<br>KIT: 525 (Hz)<br>TRAP: 579 (Hz)","DRESS: 516 (Hz)<br>KIT: 568 (Hz)<br>TRAP: 624 (Hz)","DRESS: 558 (Hz)<br>KIT: 635 (Hz)<br>TRAP: 658 (Hz)","DRESS: 605 (Hz)<br>KIT: 664 (Hz)<br>TRAP: 662 (Hz)","DRESS: 418 (Hz)<br>KIT: 496 (Hz)<br>TRAP: 486 (Hz)","DRESS: 472 (Hz)<br>KIT: 450 (Hz)<br>TRAP: 532 (Hz)","DRESS: 508 (Hz)<br>KIT: 632 (Hz)<br>TRAP: 668 (Hz)","DRESS: 494 (Hz)<br>KIT: 614 (Hz)<br>TRAP: 628 (Hz)","DRESS: 494 (Hz)<br>KIT: 566 (Hz)<br>TRAP: 566 (Hz)","DRESS: 584 (Hz)<br>KIT: 652 (Hz)<br>TRAP: 691 (Hz)","DRESS: 409 (Hz)<br>KIT: 466 (Hz)<br>TRAP: 552 (Hz)","DRESS: 541 (Hz)<br>KIT: 620 (Hz)<br>TRAP: 625 (Hz)","DRESS: 587 (Hz)<br>KIT: 674 (Hz)<br>TRAP: 738 (Hz)","DRESS: 431 (Hz)<br>KIT: 548 (Hz)<br>TRAP: 583 (Hz)","DRESS: 582 (Hz)<br>KIT: 602 (Hz)<br>TRAP: 679 (Hz)","DRESS: 594 (Hz)<br>KIT: 657 (Hz)<br>TRAP: 629 (Hz)","DRESS: 483 (Hz)<br>KIT: 542 (Hz)<br>TRAP: 571 (Hz)","DRESS: 494 (Hz)<br>KIT: 541 (Hz)<br>TRAP: 592 (Hz)","DRESS: 501 (Hz)<br>KIT: 509 (Hz)<br>TRAP: 604 (Hz)","DRESS: 467 (Hz)<br>KIT: 470 (Hz)<br>TRAP: 562 (Hz)","DRESS: 470 (Hz)<br>KIT: 486 (Hz)<br>TRAP: 616 (Hz)","DRESS: 498 (Hz)<br>KIT: 504 (Hz)<br>TRAP: 594 (Hz)","DRESS: 451 (Hz)<br>KIT: 481 (Hz)<br>TRAP: 486 (Hz)","DRESS: 474 (Hz)<br>KIT: 589 (Hz)<br>TRAP: 621 (Hz)","DRESS: 562 (Hz)<br>KIT: 560 (Hz)<br>TRAP: 612 (Hz)","DRESS: 516 (Hz)<br>KIT: 535 (Hz)<br>TRAP: 576 (Hz)","DRESS: 452 (Hz)<br>KIT: 465 (Hz)<br>TRAP: 529 (Hz)","DRESS: 380 (Hz)<br>KIT: 405 (Hz)<br>TRAP: 497 (Hz)","DRESS: 541 (Hz)<br>KIT: 539 (Hz)<br>TRAP: 621 (Hz)","DRESS: 440 (Hz)<br>KIT: 487 (Hz)<br>TRAP: 547 (Hz)","DRESS: 387 (Hz)<br>KIT: 391 (Hz)<br>TRAP: 445 (Hz)","DRESS: 467 (Hz)<br>KIT: 484 (Hz)<br>TRAP: 588 (Hz)","DRESS: 484 (Hz)<br>KIT: 505 (Hz)<br>TRAP: 558 (Hz)","DRESS: 456 (Hz)<br>KIT: 465 (Hz)<br>TRAP: 524 (Hz)","DRESS: 521 (Hz)<br>KIT: 555 (Hz)<br>TRAP: 634 (Hz)","DRESS: 474 (Hz)<br>KIT: 480 (Hz)<br>TRAP: 522 (Hz)","DRESS: 434 (Hz)<br>KIT: 490 (Hz)<br>TRAP: 546 (Hz)","DRESS: 359 (Hz)<br>KIT: 397 (Hz)<br>TRAP: 474 (Hz)","DRESS: 531 (Hz)<br>KIT: 533 (Hz)<br>TRAP: 589 (Hz)","DRESS: 511 (Hz)<br>KIT: 534 (Hz)<br>TRAP: 630 (Hz)","DRESS: 503 (Hz)<br>KIT: 521 (Hz)<br>TRAP: 647 (Hz)","DRESS: 495 (Hz)<br>KIT: 474 (Hz)<br>TRAP: 648 (Hz)","DRESS: 420 (Hz)<br>KIT: 391 (Hz)<br>TRAP: 558 (Hz)","DRESS: 394 (Hz)<br>KIT: 393 (Hz)<br>TRAP: 507 (Hz)","DRESS: 365 (Hz)<br>KIT: 457 (Hz)<br>TRAP: 494 (Hz)","DRESS: 417 (Hz)<br>KIT: 476 (Hz)<br>TRAP: 510 (Hz)","DRESS: 517 (Hz)<br>KIT: 485 (Hz)<br>TRAP: 613 (Hz)","DRESS: 532 (Hz)<br>KIT: 485 (Hz)<br>TRAP: 621 (Hz)","DRESS: 610 (Hz)<br>KIT: 536 (Hz)<br>TRAP: 695 (Hz)","DRESS: 498 (Hz)<br>KIT: 472 (Hz)<br>TRAP: 588 (Hz)","DRESS: 477 (Hz)<br>KIT: 491 (Hz)<br>TRAP: 607 (Hz)","DRESS: 603 (Hz)<br>KIT: 569 (Hz)<br>TRAP: 690 (Hz)","DRESS: 468 (Hz)<br>KIT: 447 (Hz)<br>TRAP: 594 (Hz)","DRESS: 567 (Hz)<br>KIT: 515 (Hz)<br>TRAP: 673 (Hz)","DRESS: 625 (Hz)<br>KIT: 548 (Hz)<br>TRAP: 693 (Hz)","DRESS: 444 (Hz)<br>KIT: 509 (Hz)<br>TRAP: 639 (Hz)","DRESS: 606 (Hz)<br>KIT: 558 (Hz)<br>TRAP: 712 (Hz)","DRESS: 493 (Hz)<br>KIT: 486 (Hz)<br>TRAP: 615 (Hz)","DRESS: 576 (Hz)<br>KIT: 549 (Hz)<br>TRAP: 727 (Hz)","DRESS: 459 (Hz)<br>KIT: 426 (Hz)<br>TRAP: 552 (Hz)","DRESS: 517 (Hz)<br>KIT: 456 (Hz)<br>TRAP: 615 (Hz)","DRESS: 564 (Hz)<br>KIT: 529 (Hz)<br>TRAP: 613 (Hz)","DRESS: 417 (Hz)<br>KIT: 415 (Hz)<br>TRAP: 525 (Hz)","DRESS: 522 (Hz)<br>KIT: 495 (Hz)<br>TRAP: 620 (Hz)","DRESS: 494 (Hz)<br>KIT: 461 (Hz)<br>TRAP: 597 (Hz)","DRESS: 452 (Hz)<br>KIT: 425 (Hz)<br>TRAP: 518 (Hz)","DRESS: 599 (Hz)<br>KIT: 485 (Hz)<br>TRAP: 711 (Hz)","DRESS: 418 (Hz)<br>KIT: 358 (Hz)<br>TRAP: 455 (Hz)","DRESS: 530 (Hz)<br>KIT: 451 (Hz)<br>TRAP: 646 (Hz)","DRESS: 495 (Hz)<br>KIT: 444 (Hz)<br>TRAP: 614 (Hz)","DRESS: 579 (Hz)<br>KIT: 428 (Hz)<br>TRAP: 760 (Hz)","DRESS: 550 (Hz)<br>KIT: 439 (Hz)<br>TRAP: 703 (Hz)","DRESS: 572 (Hz)<br>KIT: 419 (Hz)<br>TRAP: 751 (Hz)","DRESS: 428 (Hz)<br>KIT: 368 (Hz)<br>TRAP: 476 (Hz)","DRESS: 483 (Hz)<br>KIT: 428 (Hz)<br>TRAP: 568 (Hz)","DRESS: 454 (Hz)<br>KIT: 393 (Hz)<br>TRAP: 527 (Hz)","DRESS: 548 (Hz)<br>KIT: 405 (Hz)<br>TRAP: 700 (Hz)","DRESS: 480 (Hz)<br>KIT: 366 (Hz)<br>TRAP: 594 (Hz)","DRESS: 439 (Hz)<br>KIT: 399 (Hz)<br>TRAP: 531 (Hz)","DRESS: 484 (Hz)<br>KIT: 395 (Hz)<br>TRAP: 618 (Hz)","DRESS: 456 (Hz)<br>KIT: 397 (Hz)<br>TRAP: 528 (Hz)","DRESS: 610 (Hz)<br>KIT: 452 (Hz)<br>TRAP: 691 (Hz)","DRESS: 447 (Hz)<br>KIT: 375 (Hz)<br>TRAP: 475 (Hz)","DRESS: 515 (Hz)<br>KIT: 395 (Hz)<br>TRAP: 640 (Hz)","DRESS: 436 (Hz)<br>KIT: 406 (Hz)<br>TRAP: 492 (Hz)","DRESS: 539 (Hz)<br>KIT: 406 (Hz)<br>TRAP: 682 (Hz)","DRESS: 416 (Hz)<br>KIT: 348 (Hz)<br>TRAP: 492 (Hz)","DRESS: 422 (Hz)<br>KIT: 354 (Hz)<br>TRAP: 546 (Hz)","DRESS: 446 (Hz)<br>KIT: 387 (Hz)<br>TRAP: 505 (Hz)","DRESS: 518 (Hz)<br>KIT: 430 (Hz)<br>TRAP: 589 (Hz)","DRESS: 511 (Hz)<br>KIT: 417 (Hz)<br>TRAP: 587 (Hz)","DRESS: 475 (Hz)<br>KIT: 389 (Hz)<br>TRAP: 595 (Hz)","DRESS: 559 (Hz)<br>KIT: 440 (Hz)<br>TRAP: 645 (Hz)","DRESS: 412 (Hz)<br>KIT: 338 (Hz)<br>TRAP: 511 (Hz)","DRESS: 489 (Hz)<br>KIT: 375 (Hz)<br>TRAP: 601 (Hz)","DRESS: 448 (Hz)<br>KIT: 382 (Hz)<br>TRAP: 599 (Hz)","DRESS: 461 (Hz)<br>KIT: 378 (Hz)<br>TRAP: 618 (Hz)"],"name":"Speakers","type":"scatter3d","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[495.616517891251],"y":[481.883286403099],"z":[596.961539699471],"type":"scatter3d","mode":"markers","marker":{"color":"red","size":6,"opacity":1,"symbol":"x","line":{"color":"rgba(255,127,14,1)"}},"name":"Center","visible":"legendonly","hoverinfo":"text","text":"DRESS: 496 (Hz)<br>KIT: 482 (Hz)<br>TRAP: 597 (Hz)","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[596.460691446569,578.359663984763,551.182710677238,494.000502806792,537.40548023436,580.76653273788,604.656725459515,446.912216403679,459.776169462538,569.658395248221,548.289268744343,513.990900463925,603.539743158027,453.631356144787,561.662748697465,625.157524388126,496.159703264267,582.662837799327,589.338375994457,504.303346592859,513.278094315922,507.985547955481,473.441829667532,495.592106204783,502.926379431235,450.824216576092,532.682584948423,543.84393662241,512.788523024321,458.15173128261,409.635867870126,533.858741010749,467.551417732742,391.740633122846,486.155680749254,488.720768536569,457.783319902812,537.729583705705,466.840615693861,466.696134009689,394.503047135223,519.570342245662,526.667257555907,525.325926076708,508.025874944018,433.856924133799,412.240169377102,421.872393683911,447.033418520641,507.096071590364,513.495615048024,572.829700898463,490.57369314664,496.547630533187,580.854314039664,475.761271408521,548.279438358069,580.394468009071,503.016310788118,584.406967285974,501.782624128173,577.943035711705,453.800408889367,498.207828237272,534.187574917555,431.133864664318,514.033250974601,488.133792364811,441.539727397196,557.951890611713,391.866844406568,508.91201545069,487.784091224675,547.959464227418,527.282978152333,540.426656493526,403.890616145538,465.876034658368,434.361559986049,514.560269000386,452.309560673828,433.419053429654,470.004743678728,436.679621909645,544.084808643136,411.530742013356,484.939318225484,423.65937264528,507.043352343263,398.865596549263,418.545897431415,423.877021571956,482.178173564183,475.336064418039,458.273215647671,512.854707549714,400.021048286318,459.526720211984,450.214118491153,458.160683347364],"y":[606.456241273099,584.096015614021,550.524285502858,479.88702060917,533.505252615917,587.069224099839,616.580814059128,421.718791645671,437.609651646342,573.347325636067,546.950012457447,504.581188029852,615.201004190811,430.018954780778,563.470291774736,641.905480915878,482.554284087677,589.41173251169,597.658034593373,492.614138584809,503.700657554212,497.162767305699,454.490861655482,481.853130611153,490.913169039074,426.551291171903,527.671053171683,541.458687195071,503.095889422706,435.602980790278,375.671263862209,529.123960473183,447.214427189828,353.565254243934,470.196300464582,473.364957154415,435.14788167477,533.905618107405,446.336372393113,446.157893957648,356.977668307769,511.473480611286,520.240310458668,518.583361723476,497.212583293534,405.591570038184,378.88836131721,390.78706207072,421.868512797762,496.063995852841,503.969361232254,577.264844137321,475.653877631325,483.033491209519,587.177660470133,457.356071425537,546.937868966926,586.609611996962,491.024261375571,591.566258213745,489.500286442813,583.581354099851,430.22778588305,485.084335857998,529.530169478503,402.227770698662,504.633503677541,472.639864632198,415.082148129751,558.886263361913,353.721163227039,498.307233955583,472.20787830307,546.542604456029,521.000911010658,537.23731606112,368.574146016216,445.144824031254,406.21494744346,505.284529814472,428.386138905096,405.050667717869,450.245024313847,409.078452723074,541.756236754054,378.012004658695,468.693726062541,392.994519791479,495.998871689904,362.366731970186,386.677836391856,393.263381828466,465.282880029943,456.830812609205,435.75305060386,503.177647263584,363.79406318844,437.301506622826,425.797636116565,435.614039288944],"z":[707.306643826864,687.50024659371,657.762844452781,595.19327340823,642.687606348196,690.133876022364,716.274858793632,543.668612308382,557.744529535181,677.979196731097,654.596799850346,617.067045915416,715.052641148122,551.020788921464,669.230248526122,738.707119505565,597.555900726319,692.20883952383,699.513306715917,606.466789074042,616.287083465916,610.495905268382,572.69768592614,596.934828090954,604.960092360959,547.94917757212,637.519748317969,649.732655313463,615.751387716277,555.967046575153,502.880310759482,638.806714719615,566.252314861235,483.299094790773,586.609359471694,589.416114378877,555.56392569437,643.042244896293,565.474545335946,565.316451457814,486.321766811298,623.172149092654,630.937693013372,629.469989362051,610.540031622859,529.383329042678,505.729973866779,516.269688325643,543.801233358712,609.522627798128,616.525097691106,681.449283696546,591.44361038415,597.980376165739,690.22992754963,575.235651496223,654.586043304293,689.726757596033,605.058496508563,694.117290384504,603.708579322941,687.04436611443,551.205768797307,599.796987696883,639.166529376307,526.403719313018,617.1133864361,588.773836848015,537.78995975025,665.16977574482,483.437196941381,611.509658950179,588.391188972968,654.235923138497,631.611423095445,645.993419635685,496.593776025376,564.419087285687,529.935508645126,617.690056925648,549.5744618434,528.904204798414,568.936778399625,532.471964399733,649.996220845029,504.953708530235,585.278398598,518.225025680434,609.464941661134,491.095329352213,512.629789634227,518.463180177918,582.257115519163,574.770384064439,556.099976465299,615.823807748974,492.359640791778,557.47157867886,547.281599720698,555.976842049524],"type":"scatter3d","mode":"lines","name":"PC1","line":{"color":"#D55E00","width":6},"visible":"legendonly","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["DRESS: 596 (Hz)<br>KIT: 606 (Hz)<br>TRAP: 707 (Hz)","DRESS: 578 (Hz)<br>KIT: 584 (Hz)<br>TRAP: 688 (Hz)","DRESS: 551 (Hz)<br>KIT: 551 (Hz)<br>TRAP: 658 (Hz)","DRESS: 494 (Hz)<br>KIT: 480 (Hz)<br>TRAP: 595 (Hz)","DRESS: 537 (Hz)<br>KIT: 534 (Hz)<br>TRAP: 643 (Hz)","DRESS: 581 (Hz)<br>KIT: 587 (Hz)<br>TRAP: 690 (Hz)","DRESS: 605 (Hz)<br>KIT: 617 (Hz)<br>TRAP: 716 (Hz)","DRESS: 447 (Hz)<br>KIT: 422 (Hz)<br>TRAP: 544 (Hz)","DRESS: 460 (Hz)<br>KIT: 438 (Hz)<br>TRAP: 558 (Hz)","DRESS: 570 (Hz)<br>KIT: 573 (Hz)<br>TRAP: 678 (Hz)","DRESS: 548 (Hz)<br>KIT: 547 (Hz)<br>TRAP: 655 (Hz)","DRESS: 514 (Hz)<br>KIT: 505 (Hz)<br>TRAP: 617 (Hz)","DRESS: 604 (Hz)<br>KIT: 615 (Hz)<br>TRAP: 715 (Hz)","DRESS: 454 (Hz)<br>KIT: 430 (Hz)<br>TRAP: 551 (Hz)","DRESS: 562 (Hz)<br>KIT: 563 (Hz)<br>TRAP: 669 (Hz)","DRESS: 625 (Hz)<br>KIT: 642 (Hz)<br>TRAP: 739 (Hz)","DRESS: 496 (Hz)<br>KIT: 483 (Hz)<br>TRAP: 598 (Hz)","DRESS: 583 (Hz)<br>KIT: 589 (Hz)<br>TRAP: 692 (Hz)","DRESS: 589 (Hz)<br>KIT: 598 (Hz)<br>TRAP: 700 (Hz)","DRESS: 504 (Hz)<br>KIT: 493 (Hz)<br>TRAP: 606 (Hz)","DRESS: 513 (Hz)<br>KIT: 504 (Hz)<br>TRAP: 616 (Hz)","DRESS: 508 (Hz)<br>KIT: 497 (Hz)<br>TRAP: 610 (Hz)","DRESS: 473 (Hz)<br>KIT: 454 (Hz)<br>TRAP: 573 (Hz)","DRESS: 496 (Hz)<br>KIT: 482 (Hz)<br>TRAP: 597 (Hz)","DRESS: 503 (Hz)<br>KIT: 491 (Hz)<br>TRAP: 605 (Hz)","DRESS: 451 (Hz)<br>KIT: 427 (Hz)<br>TRAP: 548 (Hz)","DRESS: 533 (Hz)<br>KIT: 528 (Hz)<br>TRAP: 638 (Hz)","DRESS: 544 (Hz)<br>KIT: 541 (Hz)<br>TRAP: 650 (Hz)","DRESS: 513 (Hz)<br>KIT: 503 (Hz)<br>TRAP: 616 (Hz)","DRESS: 458 (Hz)<br>KIT: 436 (Hz)<br>TRAP: 556 (Hz)","DRESS: 410 (Hz)<br>KIT: 376 (Hz)<br>TRAP: 503 (Hz)","DRESS: 534 (Hz)<br>KIT: 529 (Hz)<br>TRAP: 639 (Hz)","DRESS: 468 (Hz)<br>KIT: 447 (Hz)<br>TRAP: 566 (Hz)","DRESS: 392 (Hz)<br>KIT: 354 (Hz)<br>TRAP: 483 (Hz)","DRESS: 486 (Hz)<br>KIT: 470 (Hz)<br>TRAP: 587 (Hz)","DRESS: 489 (Hz)<br>KIT: 473 (Hz)<br>TRAP: 589 (Hz)","DRESS: 458 (Hz)<br>KIT: 435 (Hz)<br>TRAP: 556 (Hz)","DRESS: 538 (Hz)<br>KIT: 534 (Hz)<br>TRAP: 643 (Hz)","DRESS: 467 (Hz)<br>KIT: 446 (Hz)<br>TRAP: 565 (Hz)","DRESS: 467 (Hz)<br>KIT: 446 (Hz)<br>TRAP: 565 (Hz)","DRESS: 395 (Hz)<br>KIT: 357 (Hz)<br>TRAP: 486 (Hz)","DRESS: 520 (Hz)<br>KIT: 511 (Hz)<br>TRAP: 623 (Hz)","DRESS: 527 (Hz)<br>KIT: 520 (Hz)<br>TRAP: 631 (Hz)","DRESS: 525 (Hz)<br>KIT: 519 (Hz)<br>TRAP: 629 (Hz)","DRESS: 508 (Hz)<br>KIT: 497 (Hz)<br>TRAP: 611 (Hz)","DRESS: 434 (Hz)<br>KIT: 406 (Hz)<br>TRAP: 529 (Hz)","DRESS: 412 (Hz)<br>KIT: 379 (Hz)<br>TRAP: 506 (Hz)","DRESS: 422 (Hz)<br>KIT: 391 (Hz)<br>TRAP: 516 (Hz)","DRESS: 447 (Hz)<br>KIT: 422 (Hz)<br>TRAP: 544 (Hz)","DRESS: 507 (Hz)<br>KIT: 496 (Hz)<br>TRAP: 610 (Hz)","DRESS: 513 (Hz)<br>KIT: 504 (Hz)<br>TRAP: 617 (Hz)","DRESS: 573 (Hz)<br>KIT: 577 (Hz)<br>TRAP: 681 (Hz)","DRESS: 491 (Hz)<br>KIT: 476 (Hz)<br>TRAP: 591 (Hz)","DRESS: 497 (Hz)<br>KIT: 483 (Hz)<br>TRAP: 598 (Hz)","DRESS: 581 (Hz)<br>KIT: 587 (Hz)<br>TRAP: 690 (Hz)","DRESS: 476 (Hz)<br>KIT: 457 (Hz)<br>TRAP: 575 (Hz)","DRESS: 548 (Hz)<br>KIT: 547 (Hz)<br>TRAP: 655 (Hz)","DRESS: 580 (Hz)<br>KIT: 587 (Hz)<br>TRAP: 690 (Hz)","DRESS: 503 (Hz)<br>KIT: 491 (Hz)<br>TRAP: 605 (Hz)","DRESS: 584 (Hz)<br>KIT: 592 (Hz)<br>TRAP: 694 (Hz)","DRESS: 502 (Hz)<br>KIT: 490 (Hz)<br>TRAP: 604 (Hz)","DRESS: 578 (Hz)<br>KIT: 584 (Hz)<br>TRAP: 687 (Hz)","DRESS: 454 (Hz)<br>KIT: 430 (Hz)<br>TRAP: 551 (Hz)","DRESS: 498 (Hz)<br>KIT: 485 (Hz)<br>TRAP: 600 (Hz)","DRESS: 534 (Hz)<br>KIT: 530 (Hz)<br>TRAP: 639 (Hz)","DRESS: 431 (Hz)<br>KIT: 402 (Hz)<br>TRAP: 526 (Hz)","DRESS: 514 (Hz)<br>KIT: 505 (Hz)<br>TRAP: 617 (Hz)","DRESS: 488 (Hz)<br>KIT: 473 (Hz)<br>TRAP: 589 (Hz)","DRESS: 442 (Hz)<br>KIT: 415 (Hz)<br>TRAP: 538 (Hz)","DRESS: 558 (Hz)<br>KIT: 559 (Hz)<br>TRAP: 665 (Hz)","DRESS: 392 (Hz)<br>KIT: 354 (Hz)<br>TRAP: 483 (Hz)","DRESS: 509 (Hz)<br>KIT: 498 (Hz)<br>TRAP: 612 (Hz)","DRESS: 488 (Hz)<br>KIT: 472 (Hz)<br>TRAP: 588 (Hz)","DRESS: 548 (Hz)<br>KIT: 547 (Hz)<br>TRAP: 654 (Hz)","DRESS: 527 (Hz)<br>KIT: 521 (Hz)<br>TRAP: 632 (Hz)","DRESS: 540 (Hz)<br>KIT: 537 (Hz)<br>TRAP: 646 (Hz)","DRESS: 404 (Hz)<br>KIT: 369 (Hz)<br>TRAP: 497 (Hz)","DRESS: 466 (Hz)<br>KIT: 445 (Hz)<br>TRAP: 564 (Hz)","DRESS: 434 (Hz)<br>KIT: 406 (Hz)<br>TRAP: 530 (Hz)","DRESS: 515 (Hz)<br>KIT: 505 (Hz)<br>TRAP: 618 (Hz)","DRESS: 452 (Hz)<br>KIT: 428 (Hz)<br>TRAP: 550 (Hz)","DRESS: 433 (Hz)<br>KIT: 405 (Hz)<br>TRAP: 529 (Hz)","DRESS: 470 (Hz)<br>KIT: 450 (Hz)<br>TRAP: 569 (Hz)","DRESS: 437 (Hz)<br>KIT: 409 (Hz)<br>TRAP: 532 (Hz)","DRESS: 544 (Hz)<br>KIT: 542 (Hz)<br>TRAP: 650 (Hz)","DRESS: 412 (Hz)<br>KIT: 378 (Hz)<br>TRAP: 505 (Hz)","DRESS: 485 (Hz)<br>KIT: 469 (Hz)<br>TRAP: 585 (Hz)","DRESS: 424 (Hz)<br>KIT: 393 (Hz)<br>TRAP: 518 (Hz)","DRESS: 507 (Hz)<br>KIT: 496 (Hz)<br>TRAP: 609 (Hz)","DRESS: 399 (Hz)<br>KIT: 362 (Hz)<br>TRAP: 491 (Hz)","DRESS: 419 (Hz)<br>KIT: 387 (Hz)<br>TRAP: 513 (Hz)","DRESS: 424 (Hz)<br>KIT: 393 (Hz)<br>TRAP: 518 (Hz)","DRESS: 482 (Hz)<br>KIT: 465 (Hz)<br>TRAP: 582 (Hz)","DRESS: 475 (Hz)<br>KIT: 457 (Hz)<br>TRAP: 575 (Hz)","DRESS: 458 (Hz)<br>KIT: 436 (Hz)<br>TRAP: 556 (Hz)","DRESS: 513 (Hz)<br>KIT: 503 (Hz)<br>TRAP: 616 (Hz)","DRESS: 400 (Hz)<br>KIT: 364 (Hz)<br>TRAP: 492 (Hz)","DRESS: 460 (Hz)<br>KIT: 437 (Hz)<br>TRAP: 557 (Hz)","DRESS: 450 (Hz)<br>KIT: 426 (Hz)<br>TRAP: 547 (Hz)","DRESS: 458 (Hz)<br>KIT: 436 (Hz)<br>TRAP: 556 (Hz)"],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[475.487287581051,479.639989733819,478.938843474485,477.061487721067,481.078088320878,475.006168154693,473.737335593628,463.277849051427,489.086380296389,472.283069807145,467.901021900177,468.429744866543,479.800877883325,481.881937508479,470.896818421587,483.306242349571,469.427304802232,489.763525702555,468.153754843053,474.323367264549,479.387350873333,490.776211309856,489.020228665923,495.278857121386,489.669572476012,470.289074267217,470.694516889147,486.150463396052,480.64229949382,482.660515341582,483.866399791617,490.469225605181,478.87906642412,478.541226086914,490.215417358325,481.403258701619,481.886665017435,486.656268932802,479.915550696741,477.50627860966,479.383562199591,485.109333999377,490.343169796739,495.860159978437,507.120616619933,503.027851294999,490.338121527453,468.471175914975,472.438825891326,500.278465515137,503.44244687909,512.612581608648,496.822551652875,493.281998235973,502.659926366013,500.681366005703,509.130444094716,510.834593822201,490.851011823517,509.822778046422,497.556596881763,511.568818365143,497.294640879568,507.728510713379,494.288967718947,490.705622227893,499.417910383636,500.782834542401,490.533075226909,527.088328252143,492.334162989208,516.153682374387,508.330360816957,548.260740892916,531.975256791479,548.42414711087,494.668205788728,502.325730947292,500.515412495239,539.80471849905,522.611612409621,498.142788405969,520.249453523223,499.893081814154,532.872857619783,494.706229322314,527.642637305215,489.00615632034,535.23481142855,501.14863748148,510.442078395275,496.999622395034,509.540760966483,511.813155928786,516.411899458993,522.191585184459,506.725154979739,522.588710276564,515.821795454075,521.950512948574],"y":[528.164156891457,518.616316882314,520.228383450264,524.544775937487,515.309858889062,529.270340561551,532.187624259195,556.235942777814,496.897295763696,535.531253671879,545.606402524112,544.390769399868,518.246404893844,513.461659053786,538.718505238413,510.186915465945,542.097192274637,495.340411652301,545.025322154066,530.840227689828,519.197180939324,493.012057775145,497.049390751681,482.659631753531,495.55642771663,540.115822873763,539.183634350564,503.64751858569,516.311819021394,511.671562795576,508.899008594748,493.717875405571,520.3658220847,521.142580294083,494.30142810086,514.56223128255,513.450789625281,502.48457692434,517.982750618722,523.522118379689,519.205891809837,506.041270061857,494.007701318182,481.32310761291,455.433208822255,464.843242838635,494.01930823476,544.295511659899,535.173141262777,471.164595679228,463.890009941168,442.806152722622,479.110388906961,487.250784322961,465.689171159063,470.238251992151,450.812239036976,446.894079643143,492.840077384845,449.22043361472,477.422681446355,445.205959905946,478.024967357164,454.035546448888,484.935572886206,493.174355295213,473.143173099991,470.004956822232,493.571073166816,409.523700025443,489.430035075416,434.664498849133,452.651780340206,360.844357981391,398.287736040258,360.46865648195,484.063633536251,466.457549018192,470.619810194153,380.286337194022,419.81650819188,476.074917344348,425.247553880643,472.050664986334,396.223983624253,483.976210311106,408.249239695841,497.081745709787,390.793409447374,469.163907354025,447.796546123894,478.703270107145,449.868843700501,444.644182085128,434.070809410125,420.782229449461,456.342449199105,419.86916448512,435.427569038059,421.336499670201],"z":[563.109297451902,570.0930855596,568.91393600166,565.756701434306,572.511601369434,562.300177027519,560.166323593142,542.576129295829,585.979510264436,557.720618668626,550.35112937365,551.240306836645,570.363658479077,573.863471113574,555.389296655972,576.258789353368,552.917948757325,587.118296495857,550.776161859956,561.151879711436,569.668211295929,588.821375946521,585.868260058387,596.393680223336,586.960291081052,554.367225666609,555.049076966611,581.042045264664,571.778715475885,575.172840871315,577.200831604,588.305104122856,568.813406216934,568.245244754232,587.878263248935,573.05845519002,573.871421580429,581.892681443811,570.556508965614,566.504726504224,569.661839710959,579.291130599564,588.093110335795,597.371283680242,616.308505827927,609.425516209993,588.084620431703,551.309983315402,557.982560760398,604.801749080419,610.12276046281,625.544593166993,598.989781536248,593.035471802969,608.806760120813,605.47932516247,619.68852411495,622.554470229727,588.947171372857,620.8528536143,600.224258787791,623.789249041869,599.783715463089,617.330828976656,594.728938187338,588.70266307644,603.354514370992,605.649969416218,588.412482936098,649.889114767588,591.44145415352,631.499823401708,618.342987672695,685.495724192579,658.107684787941,685.770531862306,595.366720100004,608.244728483326,605.20023359506,671.274846686747,642.360418099153,601.210083738624,638.387868050426,604.153631780209,659.61722093081,595.430666006043,650.821321516454,585.844593954701,663.589426091155,606.265156858449,621.894359181592,599.287569457899,620.378572662624,624.200162637032,631.934078818623,641.654039208473,615.643439998923,642.321902540223,630.941674071005,641.248617063533],"type":"scatter3d","mode":"lines","name":"PC2","line":{"color":"#0072B2","width":4},"visible":"legendonly","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["DRESS: 475 (Hz)<br>KIT: 528 (Hz)<br>TRAP: 563 (Hz)","DRESS: 480 (Hz)<br>KIT: 519 (Hz)<br>TRAP: 570 (Hz)","DRESS: 479 (Hz)<br>KIT: 520 (Hz)<br>TRAP: 569 (Hz)","DRESS: 477 (Hz)<br>KIT: 525 (Hz)<br>TRAP: 566 (Hz)","DRESS: 481 (Hz)<br>KIT: 515 (Hz)<br>TRAP: 573 (Hz)","DRESS: 475 (Hz)<br>KIT: 529 (Hz)<br>TRAP: 562 (Hz)","DRESS: 474 (Hz)<br>KIT: 532 (Hz)<br>TRAP: 560 (Hz)","DRESS: 463 (Hz)<br>KIT: 556 (Hz)<br>TRAP: 543 (Hz)","DRESS: 489 (Hz)<br>KIT: 497 (Hz)<br>TRAP: 586 (Hz)","DRESS: 472 (Hz)<br>KIT: 536 (Hz)<br>TRAP: 558 (Hz)","DRESS: 468 (Hz)<br>KIT: 546 (Hz)<br>TRAP: 550 (Hz)","DRESS: 468 (Hz)<br>KIT: 544 (Hz)<br>TRAP: 551 (Hz)","DRESS: 480 (Hz)<br>KIT: 518 (Hz)<br>TRAP: 570 (Hz)","DRESS: 482 (Hz)<br>KIT: 513 (Hz)<br>TRAP: 574 (Hz)","DRESS: 471 (Hz)<br>KIT: 539 (Hz)<br>TRAP: 555 (Hz)","DRESS: 483 (Hz)<br>KIT: 510 (Hz)<br>TRAP: 576 (Hz)","DRESS: 469 (Hz)<br>KIT: 542 (Hz)<br>TRAP: 553 (Hz)","DRESS: 490 (Hz)<br>KIT: 495 (Hz)<br>TRAP: 587 (Hz)","DRESS: 468 (Hz)<br>KIT: 545 (Hz)<br>TRAP: 551 (Hz)","DRESS: 474 (Hz)<br>KIT: 531 (Hz)<br>TRAP: 561 (Hz)","DRESS: 479 (Hz)<br>KIT: 519 (Hz)<br>TRAP: 570 (Hz)","DRESS: 491 (Hz)<br>KIT: 493 (Hz)<br>TRAP: 589 (Hz)","DRESS: 489 (Hz)<br>KIT: 497 (Hz)<br>TRAP: 586 (Hz)","DRESS: 495 (Hz)<br>KIT: 483 (Hz)<br>TRAP: 596 (Hz)","DRESS: 490 (Hz)<br>KIT: 496 (Hz)<br>TRAP: 587 (Hz)","DRESS: 470 (Hz)<br>KIT: 540 (Hz)<br>TRAP: 554 (Hz)","DRESS: 471 (Hz)<br>KIT: 539 (Hz)<br>TRAP: 555 (Hz)","DRESS: 486 (Hz)<br>KIT: 504 (Hz)<br>TRAP: 581 (Hz)","DRESS: 481 (Hz)<br>KIT: 516 (Hz)<br>TRAP: 572 (Hz)","DRESS: 483 (Hz)<br>KIT: 512 (Hz)<br>TRAP: 575 (Hz)","DRESS: 484 (Hz)<br>KIT: 509 (Hz)<br>TRAP: 577 (Hz)","DRESS: 490 (Hz)<br>KIT: 494 (Hz)<br>TRAP: 588 (Hz)","DRESS: 479 (Hz)<br>KIT: 520 (Hz)<br>TRAP: 569 (Hz)","DRESS: 479 (Hz)<br>KIT: 521 (Hz)<br>TRAP: 568 (Hz)","DRESS: 490 (Hz)<br>KIT: 494 (Hz)<br>TRAP: 588 (Hz)","DRESS: 481 (Hz)<br>KIT: 515 (Hz)<br>TRAP: 573 (Hz)","DRESS: 482 (Hz)<br>KIT: 513 (Hz)<br>TRAP: 574 (Hz)","DRESS: 487 (Hz)<br>KIT: 502 (Hz)<br>TRAP: 582 (Hz)","DRESS: 480 (Hz)<br>KIT: 518 (Hz)<br>TRAP: 571 (Hz)","DRESS: 478 (Hz)<br>KIT: 524 (Hz)<br>TRAP: 567 (Hz)","DRESS: 479 (Hz)<br>KIT: 519 (Hz)<br>TRAP: 570 (Hz)","DRESS: 485 (Hz)<br>KIT: 506 (Hz)<br>TRAP: 579 (Hz)","DRESS: 490 (Hz)<br>KIT: 494 (Hz)<br>TRAP: 588 (Hz)","DRESS: 496 (Hz)<br>KIT: 481 (Hz)<br>TRAP: 597 (Hz)","DRESS: 507 (Hz)<br>KIT: 455 (Hz)<br>TRAP: 616 (Hz)","DRESS: 503 (Hz)<br>KIT: 465 (Hz)<br>TRAP: 609 (Hz)","DRESS: 490 (Hz)<br>KIT: 494 (Hz)<br>TRAP: 588 (Hz)","DRESS: 468 (Hz)<br>KIT: 544 (Hz)<br>TRAP: 551 (Hz)","DRESS: 472 (Hz)<br>KIT: 535 (Hz)<br>TRAP: 558 (Hz)","DRESS: 500 (Hz)<br>KIT: 471 (Hz)<br>TRAP: 605 (Hz)","DRESS: 503 (Hz)<br>KIT: 464 (Hz)<br>TRAP: 610 (Hz)","DRESS: 513 (Hz)<br>KIT: 443 (Hz)<br>TRAP: 626 (Hz)","DRESS: 497 (Hz)<br>KIT: 479 (Hz)<br>TRAP: 599 (Hz)","DRESS: 493 (Hz)<br>KIT: 487 (Hz)<br>TRAP: 593 (Hz)","DRESS: 503 (Hz)<br>KIT: 466 (Hz)<br>TRAP: 609 (Hz)","DRESS: 501 (Hz)<br>KIT: 470 (Hz)<br>TRAP: 605 (Hz)","DRESS: 509 (Hz)<br>KIT: 451 (Hz)<br>TRAP: 620 (Hz)","DRESS: 511 (Hz)<br>KIT: 447 (Hz)<br>TRAP: 623 (Hz)","DRESS: 491 (Hz)<br>KIT: 493 (Hz)<br>TRAP: 589 (Hz)","DRESS: 510 (Hz)<br>KIT: 449 (Hz)<br>TRAP: 621 (Hz)","DRESS: 498 (Hz)<br>KIT: 477 (Hz)<br>TRAP: 600 (Hz)","DRESS: 512 (Hz)<br>KIT: 445 (Hz)<br>TRAP: 624 (Hz)","DRESS: 497 (Hz)<br>KIT: 478 (Hz)<br>TRAP: 600 (Hz)","DRESS: 508 (Hz)<br>KIT: 454 (Hz)<br>TRAP: 617 (Hz)","DRESS: 494 (Hz)<br>KIT: 485 (Hz)<br>TRAP: 595 (Hz)","DRESS: 491 (Hz)<br>KIT: 493 (Hz)<br>TRAP: 589 (Hz)","DRESS: 499 (Hz)<br>KIT: 473 (Hz)<br>TRAP: 603 (Hz)","DRESS: 501 (Hz)<br>KIT: 470 (Hz)<br>TRAP: 606 (Hz)","DRESS: 491 (Hz)<br>KIT: 494 (Hz)<br>TRAP: 588 (Hz)","DRESS: 527 (Hz)<br>KIT: 410 (Hz)<br>TRAP: 650 (Hz)","DRESS: 492 (Hz)<br>KIT: 489 (Hz)<br>TRAP: 591 (Hz)","DRESS: 516 (Hz)<br>KIT: 435 (Hz)<br>TRAP: 631 (Hz)","DRESS: 508 (Hz)<br>KIT: 453 (Hz)<br>TRAP: 618 (Hz)","DRESS: 548 (Hz)<br>KIT: 361 (Hz)<br>TRAP: 685 (Hz)","DRESS: 532 (Hz)<br>KIT: 398 (Hz)<br>TRAP: 658 (Hz)","DRESS: 548 (Hz)<br>KIT: 360 (Hz)<br>TRAP: 686 (Hz)","DRESS: 495 (Hz)<br>KIT: 484 (Hz)<br>TRAP: 595 (Hz)","DRESS: 502 (Hz)<br>KIT: 466 (Hz)<br>TRAP: 608 (Hz)","DRESS: 501 (Hz)<br>KIT: 471 (Hz)<br>TRAP: 605 (Hz)","DRESS: 540 (Hz)<br>KIT: 380 (Hz)<br>TRAP: 671 (Hz)","DRESS: 523 (Hz)<br>KIT: 420 (Hz)<br>TRAP: 642 (Hz)","DRESS: 498 (Hz)<br>KIT: 476 (Hz)<br>TRAP: 601 (Hz)","DRESS: 520 (Hz)<br>KIT: 425 (Hz)<br>TRAP: 638 (Hz)","DRESS: 500 (Hz)<br>KIT: 472 (Hz)<br>TRAP: 604 (Hz)","DRESS: 533 (Hz)<br>KIT: 396 (Hz)<br>TRAP: 660 (Hz)","DRESS: 495 (Hz)<br>KIT: 484 (Hz)<br>TRAP: 595 (Hz)","DRESS: 528 (Hz)<br>KIT: 408 (Hz)<br>TRAP: 651 (Hz)","DRESS: 489 (Hz)<br>KIT: 497 (Hz)<br>TRAP: 586 (Hz)","DRESS: 535 (Hz)<br>KIT: 391 (Hz)<br>TRAP: 664 (Hz)","DRESS: 501 (Hz)<br>KIT: 469 (Hz)<br>TRAP: 606 (Hz)","DRESS: 510 (Hz)<br>KIT: 448 (Hz)<br>TRAP: 622 (Hz)","DRESS: 497 (Hz)<br>KIT: 479 (Hz)<br>TRAP: 599 (Hz)","DRESS: 510 (Hz)<br>KIT: 450 (Hz)<br>TRAP: 620 (Hz)","DRESS: 512 (Hz)<br>KIT: 445 (Hz)<br>TRAP: 624 (Hz)","DRESS: 516 (Hz)<br>KIT: 434 (Hz)<br>TRAP: 632 (Hz)","DRESS: 522 (Hz)<br>KIT: 421 (Hz)<br>TRAP: 642 (Hz)","DRESS: 507 (Hz)<br>KIT: 456 (Hz)<br>TRAP: 616 (Hz)","DRESS: 523 (Hz)<br>KIT: 420 (Hz)<br>TRAP: 642 (Hz)","DRESS: 516 (Hz)<br>KIT: 435 (Hz)<br>TRAP: 631 (Hz)","DRESS: 522 (Hz)<br>KIT: 421 (Hz)<br>TRAP: 641 (Hz)"],"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

Data: Mean first formant values in Hz for &lt;span style="font-variant: small-caps;"&gt;dress, kit&lt;/span&gt; and &lt;span style="font-variant: small-caps;"&gt;trap&lt;/span&gt; from 100 random [ONZE](https://www.canterbury.ac.nz/nzilbb/research/onze/) speakers.

???

1. find the centre of the cloud,

2. draw the line which stays in the cloud for the longest (PC1),

3. draw the line _at right angles to PC1_ which stays in the cloud for the longest (PC2)

---

# From 3D to 2D

.pull-left[

- (Intuitive) PCA:

  1. Find the centre,
  2. draw the line which captures maximum variance (PC1),
  3. draw the line orthogonal to PC1 which captures maximum variance, and
  4. repeat until you run out of options!

- We can plot our original three-variable data against PC1 and PC2 (see right).

]

.pull-right[

&lt;img src="pca_presentation_files/figure-html/unnamed-chunk-3-1.png" width="100%" /&gt;

]

???

Note that this is not that impressive for three dimensions, but it is _great_
for 20 or 30!

PCA can allow us to see patterns in the data which would not otherwise be 
visible to creatures like us!

---

# What do the PCs Mean?

.pull-left[

- PC1: decrease in all variables.
- PC2: decrease in .sc[kit] and
increase in .sc[dress] and
.sc[trap].
- _Supplementary variables_ can help interpretation (see right).
- Interpretation:
  - PC1: vocal tract length
  - PC2: short front vowel shift
- We've lost information, but our new description captures deeper phenomena.

]

.pull-right[

&lt;img src="pca_presentation_files/figure-html/unnamed-chunk-4-1.png" width="100%" /&gt;

]

???

Take stock:

- We've seen:
  - a method for PCA in 3D space,
    - Not _mathematical_: haven't told you _how_ to maximise variance
  - PCA as _dimensionality reduction_
  - PCs as _interpretable_
    - both in terms of the relationship between variables PCs represent _and_
    - in terms of supplementary variables.

---

# PCA in General

**From 'the textbook':**
&gt; The central idea of principal component analysis (PCA) is to reduce the 
dimensionality of a data set consisting of a large number of interrelated 
variables, while retaining as much as possible of the variation present in
the data set. This is achieved by transforming to a new set of variables,
the principal components (PCs), which are uncorrelated, and which are ordered
so that the first _few_ retain most of the variation present in _all_ of the 
original variables. [(Jolliffe, 2002)](https://doi.org/10.1007/b98835)


--

- 'Reduce dimensionality' = we end up with fewer variables.
- 'Interrelated variables' = there is structure in the correlations between variables.
- Another intuition: PCA finds structure in the correlation matrix.
- 'First few': _few_ is not mathematically defined.
- Often, we want _interpretable_ PCs.
  - PCs can capture _meaningful information_ present, but not immediately
  obvious, in the original data.
  - PCA is thus an important tool for _exploratory data analysis_.
- PCA also useful for hypothesis testing: PCs can be used as independent variables.

???

Correlation matrix point in more detail:
- PCs represent eigenvalues of correlation matrices.

---

# Worked Example: Patterns in ONZE 

.left-column[
![](images/mobileunit.png)
.tiny[NZBC mobile recording unit.]
]

.right-column[
- **Target:** explore patterns in the behaviour of monophthongs in the ONZE corpus.
- A simplification of the analysis in [Brand et al. (2021)](https://doi.org/10.1016/j.wocn.2021.101096).
  - 100 random speakers, 50 born in 1920 or before, 50 born after 1920.
  - first and second formant data for 10 monophthongs filtered to exclude stopwords, outliers, and
  formant tracking errors ([details](https://osf.io/zeb3g)).
- We move from readings of _individual vowels_ to _systems of vowels_.
- This is PCA in its _exploratory_ use.

**Steps:**

1. Preprocessing,
2. application of PCA,
3. interpretation of PCA

]

---

# Libraries

**Time for some R:**



```r
# We're working in the tidyverse 'dialect'.
library(tidyverse)

# Factoextra used for PCA visualisation
library(factoextra)

# nzilbb.vowels used to share the data and some useful functions.
# Install via github using following commented line.
# remotes::install_github('https://github.com/JoshuaWilsonBlack/nzilbb_vowels')
library(nzilbb.vowels)

# We will fit GAMM models as part of our preprocessing example
library(mgcv)
library(itsadug)
```

--

**NB:** No special package required for running PCA.
---

# Preprocessing

&gt; Doing data analysis, in good mathematics, is simply searching for
eigenvectors; all the science of it (the art) is to find the right matrix to
diagonalize (Benzécri, cited by [Husson](https://www.youtube.com/playlist?list=PLnZgp6epRBbRX8TEp1HlFGqfMf_AxYEj7))

--

PCA does this for the correlation matrix. But careful data selection is also
required _before_ PCA. 

What do we need from our data?

--

1. Technical requirements:
  - a row for each speaker, and
  - a column for each variable
      - i.e. two for each vowel (F1 and F2 for each).
2. Research requirements:
  - patterns which are present _across_ the development of NZE,
  - patterns not explained by other known sources of covariation.
  
--

**Thoughtful preprocessing is required for meaningful results.**
  
???

My use of the quote is a bit loose - we will be processing matrices _derived from_
our data.

---

# Raw Data


```r
# onze_vowels comes from the nzilbb.vowels package.
onze_vowels %&gt;%
  head(5)
```

```
##    speaker   vowel F1_50 F2_50 speech_rate gender  yob       word
## 1 IA_f_065 THOUGHT   514   868      4.3131      F 1891 word_09539
## 2 IA_f_065  FLEECE   395  2716      4.3131      F 1891 word_22664
## 3 IA_f_065     KIT   653  2413      4.3131      F 1891 word_02705
## 4 IA_f_065   DRESS   612  2372      4.3131      F 1891 word_23651
## 5 IA_f_065   GOOSE   445  2037      4.3131      F 1891 word_06222
```

--

1. Technical requirements:
  - Make the data 'wider' so that:
      - each vowel-formant pair has a column,
      - each speaker has a row.
2. Research requirements:
  - Control for `yob` (year of birth), `speech_rate`, and `gender`.
  - Normalise vowel space to enable across-speaker comparisons.

---

# Preprocessing

After normalisation, we can kill two birds with one stone:

--

1. Fit a mixed-effect regression models for each vowel-formant pair, where:
  - sources of unwanted variation are the fixed effects, and
  - there are by-speaker random intercepts.
2. Extract random intercepts for each speaker from each model.
  - for exploitation of by-speaker random effects see [Drager and Hay (2012)](https://doi.org/10.1017/S0954394512000014).
3. Create matrix with row for each speaker, and column for each random intercept value.

--

The result satisfies both the technical and research requirements.

---

# Preprocessing: Normalisation

We apply Lobanov 2.0 normalisation using `lobanov_2` from `nzilbb.vowel`.


```r
onze_ints &lt;- onze_vowels %&gt;%
  # Add F1_lob2 and F2_lob2 columns
  lobanov_2() %&gt;%
  # Remove F1_50 and F2_50 columns
  select(-(F1_50:F2_50))

onze_ints %&gt;%
  head(5)
```

```
## # A tibble: 5 × 8
##   speaker  vowel   speech_rate gender   yob word       F1_lob2 F2_lob2
##   &lt;fct&gt;    &lt;fct&gt;         &lt;dbl&gt; &lt;fct&gt;  &lt;int&gt; &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;
## 1 IA_f_065 THOUGHT        4.31 F       1891 word_09539  -0.708 -2.45  
## 2 IA_f_065 FLEECE         4.31 F       1891 word_22664  -1.76   1.41  
## 3 IA_f_065 KIT            4.31 F       1891 word_02705   0.518  0.773 
## 4 IA_f_065 DRESS          4.31 F       1891 word_23651   0.157  0.688 
## 5 IA_f_065 GOOSE          4.31 F       1891 word_06222  -1.32  -0.0111
```

---

# Preprocessing: Modelling

**Step 1:** reshape data so we have a row for each model we want to fit.
--

```r
onze_ints &lt;- onze_ints %&gt;%
  pivot_longer(
    cols = F1_lob2:F2_lob2, # Select columns with formant data.
    names_to = "formant_type", # Name column to distinguish F1 &amp; F2
    values_to = "formant_value" # Name column for formant values.
  ) %&gt;%
  group_by(vowel, formant_type) %&gt;%
  nest() %&gt;%
  ungroup()

onze_ints %&gt;% head(3)
```

```
## # A tibble: 3 × 3
##   vowel   formant_type data                 
##   &lt;fct&gt;   &lt;chr&gt;        &lt;list&gt;               
## 1 THOUGHT F1_lob2      &lt;tibble [6,942 × 6]&gt; 
## 2 THOUGHT F2_lob2      &lt;tibble [6,942 × 6]&gt; 
## 3 FLEECE  F1_lob2      &lt;tibble [11,896 × 6]&gt;
```

--

Column `data` contains data frames ('tibbles') with the data for each model.

---

# Preprocessing: Modelling

**Step 2:** Fit models for each vowel-formant pair and extract random effects.

--




```r
# gam version
onze_ints &lt;- onze_ints %&gt;%
  # For each vowel-formant pair, fit an lmer model.
  mutate(
    model = map( # map takes...
      data, # ... each entry in a column, and ...
      ~ bam( # applies a function to it.
          formant_value ~ gender + s(yob, by=gender) 
            + s(speech_rate) + s(speaker, bs="re"),
          discrete = TRUE, nthreads = 2,
          data = .x # where .x is a pronoun referring to the column entry.
      )
    ),
    # For each model, extract random effects and turn them into a dataframe
    random_intercepts = map(
      model,
      ~ get_random(.x)$`s(speaker)` %&gt;% as_tibble(rownames = "speaker") %&gt;%
        rename(intercept = value)
    )
  )
```

---

# Preprocessing: Modelling

**Step 3:** Reshape random intercept data for use in PCA.

--


```r
# Select the vowel, formant type, and random intercepts columns and 'unnest'
onze_ints &lt;- onze_ints %&gt;%
  select(vowel, formant_type, random_intercepts) %&gt;%
  unnest(random_intercepts)

onze_ints %&gt;%
  head(5)
```

```
## # A tibble: 5 × 4
##   vowel   formant_type speaker  intercept
##   &lt;fct&gt;   &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt;
## 1 THOUGHT F1_lob2      CC_f_020  -0.114  
## 2 THOUGHT F1_lob2      CC_f_084   0.00552
## 3 THOUGHT F1_lob2      CC_f_170  -0.0661 
## 4 THOUGHT F1_lob2      CC_f_186   0.284  
## 5 THOUGHT F1_lob2      CC_f_210   0.242
```
--

Almost there! We just need to reshape this so we have a single row for each
speaker, and a column for each vowel-formant pair.

---

# Preprocessing: Modelling

**Step 3 (cont):** Reshape random intercept data for use in PCA.


```r
onze_ints &lt;- onze_ints %&gt;%
  # Create a column to store our eventual column names
  mutate(
    # Combine the 'vowel' and 'formant_type' columns as a string.
    vowel_formant = str_c(vowel, '_', formant_type),
    # Remove '_lob2' for cleaner column names
    vowel_formant = str_replace(vowel_formant, '_lob2', '')
  ) %&gt;%
  # Remove old 'vowel' and 'formant_type' columns
  select(-c(vowel, formant_type)) %&gt;%
  # Make data 'wider', by...
  pivot_wider(
    names_from = vowel_formant, # naming columns using 'vowel_formant'...
    values_from = intercept # and values from intercept column
  )
```

---

# Preprocessing: Modelling

**Step 3 (cont):** Reshape random intercept data for use in PCA.

--

What does the data look like now?

--


```r
onze_ints %&gt;%
  head(5)
```

```
## # A tibble: 5 × 21
##   speaker  THOUGHT_F1 THOUGHT…¹ FLEECE…² FLEEC…³  KIT_F1  KIT_F2 DRESS…⁴ DRESS…⁵
##   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 CC_f_020   -0.114     -0.331  -0.106   -0.196   0.178   0.145   0.232  -0.0675
## 2 CC_f_084    0.00552    0.202  -0.112    0.167  -0.0660 -0.129  -0.0905  0.0647
## 3 CC_f_170   -0.0661     0.0271  0.270   -0.0465 -0.233  -0.0840 -0.146  -0.101 
## 4 CC_f_186    0.284     -0.0704 -0.0491  -0.0812  0.0424 -0.239   0.0361  0.0651
## 5 CC_f_210    0.242     -0.0819  0.00588 -0.0770 -0.162   0.168   0.0635 -0.0108
## # … with 12 more variables: GOOSE_F1 &lt;dbl&gt;, GOOSE_F2 &lt;dbl&gt;, TRAP_F1 &lt;dbl&gt;,
## #   TRAP_F2 &lt;dbl&gt;, START_F1 &lt;dbl&gt;, START_F2 &lt;dbl&gt;, STRUT_F1 &lt;dbl&gt;,
## #   STRUT_F2 &lt;dbl&gt;, NURSE_F1 &lt;dbl&gt;, NURSE_F2 &lt;dbl&gt;, LOT_F1 &lt;dbl&gt;, LOT_F2 &lt;dbl&gt;,
## #   and abbreviated variable names ¹​THOUGHT_F2, ²​FLEECE_F1, ³​FLEECE_F2,
## #   ⁴​DRESS_F1, ⁵​DRESS_F2
## # ℹ Use `colnames()` to see all variable names
```

--

**Yay!** a row for each speaker, and a column for each variable.

---

# Preprocessing Tips

--

- PCA requires _complete observations_.
  - i.e. each row has a value for each variable.
- If we are missing data, we have a few options:
  1. delete the column with missing data,
  2. delete the row with missing data, or
  3. impute values.
- Which option to choose depends on context.
  - e.g. all three used in Wilson Black et al. (under review):
      1. both &lt;span style="font-variant: small-caps;"&gt;foot&lt;/span&gt; columns removed,
      2. rows missing more than 3 values removed (very), and
      3. mean values imputed for remaining rows.

???

Taking stock:
- Specific steps carried out above were _problem specific_.
- The details are not vital for understanding PCA.
- At this point all that matters is that we have a row for each speaker, and
a column for each speaker. i.e. we now have a multivariate space to reduce!


---

# Apply PCA

--

We have a multivariate dataset containing information about 10 New Zealand
English monophthongs. 

**We can now apply PCA** to find meaningful patterns in this
data:

--


```r
onze_pca &lt;- onze_ints %&gt;%
  # Remove the speaker column as this is not wanted by PCA.
  select(-speaker) %&gt;%
  # We scale the variables (more on this in a moment)
  prcomp(scale = TRUE)
```

--

- `prcomp` is the recommended function for PCA (rather than `princomp`).
- For historical reasons, `prcomp` does not scale variables by default.
- But variable scaling is pretty much always recommended.
  - Why?: because variables with higher variance will dominate variables with lower variance.

--

**What now?**

1. How many PCs should we look at?
2. What do the PCs mean?
  
---

# How Many PCs?: Scree Plots

--

.pull-left[

```r
fviz_eig(onze_pca)
```

&lt;img src="pca_presentation_files/figure-html/unnamed-chunk-15-1.png" height="450px" /&gt;
] 

.pull-right[
- The `fviz_eig` function from `factoextra` plots the variance explained by each 
PC.
- Each PC explains less (or equal) variance, than the previous PC.
- The scree plot is used to select which PCs we will use.
- **How to use:** two options:
    1. use a cut off value (e.g. 10%), or
    2. 'the elbow rule': ignore PCs after the 'elbow' in the scree plot.
- In this case, _both_ methods can motivate selecting the first two PCs.
- The second method _might_ allow you to pick the first six PCs.
    
]

???

One always picks the _first_ _n_ PCs in standard use of PCA.

Function name: `fviz_eig`: under the hood - these are eigenvalues of matrices.

The function produces ggplot objects - which can be modified in the usual ggplot
way. e.g. (`+ labs(...)`).

---

# Interpretation: Variable Plots

--

.pull-left[

```r
fviz_pca_var(
  onze_pca, repel = TRUE, 
  select.var = list(cos2 = 10) 
)
```

&lt;img src="pca_presentation_files/figure-html/unnamed-chunk-16-1.png" height="400px" /&gt;
] 

.pull-right[
- Variable plots plot the relationship between the original variables and the
selected PCs (in this case: PC1 and PC2.)
- **Positives:** get a sense of the PC space as a whole and relations between
variables which might be invisible from a single PC.
- **Negatives:** they can be very messy!
- Some technical points:
  - This plot restricts shown variables to the 10 most well represented by PC1 and PC2 (`list(cos2 = 10)`). 
  - `repel = TRUE` prevents labels from overlapping.
  - If you want to look at, e.g., PC3 and PC4, use `axes = c(3, 4)`.
]

???

PC1 seems to match Brand 2021 PC2, while PC2 gets the DRESS F2, GOOSE F2
relationship in Brand's PC3 and PC1. Let's wait for the contribution plots.

---

# Interpretation: Contribution Plots

.pull-left[

```r
pca_contrib_plot(
  onze_pca, pc_no=1, cutoff=50
)
```

![](pca_presentation_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;
]

.pull-right[
  - This kind of plot was used to interpret PCs in Brand et al. (2021)
  - We interpret the PC with reference to the variables which explain the 50%
  of the variance.
  - Here we are given the percentage contribution of the original variables,
  and their relationship to one another.
  - **NB:** the signs can be flipped without affecting the meaning of the PCs!
  - Don't let yourself be bullied by strict cutoffs, but they can help to focus interpretation.
  - 
]

---

# Interpretation: Contribution Plots

.pull-left[

```r
pca_contrib_plot(
  onze_pca, pc_no=2, cutoff=50
)
```

![](pca_presentation_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;
]

.pull-right[
- PC1 has loadings which slowly trail off.
- Often it is easier to interpret PCs which involve only a handful of original
variables.
- We avoid getting into the weeds with these particular plots!
- **The point:** PCs can be interpreted _one-by-one_ as in these plots, or
_together_ as in the variable plots.
]

---

# Interpretation: Theory

--

- Variance explained is calculated from the square roots of 
the eigenvalues of the correlation matrix (in, e.g., `onze_pca$sdev`).
  - To turn into percentages: e.g., `onze_pca$sdev^2/sum(onze_pca$sdev^2) * 100`
- Interpretation of PCs usually focuses on two quantities:
  1. the _loadings_: the contribution of each original variable to a given PC.
  2. the _scores_: the position of individuals in PC space. 
- It can be useful to see these directly:
  - loadings can be access by adding `$rotation` (e.g. `onze_pca$rotation`).
  - scores can be accessed by adding `$x` to the name of your pca object (e.g. `onze_pca$x`).
- **Scores** can be useful as either response or predictor in regression models.

--


```r
onze_pca$rotation[1:5, 1:5]
```

```
##                   PC1         PC2         PC3         PC4         PC5
## THOUGHT_F1  0.3572963 -0.04267274  0.08444889 -0.14809462  0.34717131
## THOUGHT_F2  0.1412604 -0.31325372  0.03986780  0.16732278  0.31588925
## FLEECE_F1  -0.3153993 -0.16235352 -0.21469142 -0.32770244 -0.04562523
## FLEECE_F2   0.3106982 -0.05124337 -0.37692977  0.18536913 -0.05316580
## KIT_F1     -0.1130919  0.05917746  0.45148138  0.04650166 -0.17518187
```


---

# Testing: Permutation


```r
permutation_results &lt;- permutation_test(
  onze_ints %&gt;% select(-speaker), pc_n = 5, n = 100
)
plot_permutation_test(permutation_results)
```

![](pca_presentation_files/figure-html/unnamed-chunk-20-1.png)&lt;!-- --&gt;

---

# Testing: Permutation

- Permutation offers: a way to discern whether there are real patterns in your data.
- The method: each variable is shuffled independently.
- Left panel: the number of significant pairwise correlations in the data.
  - Remember: PCA as investigation of the correlation matrix.
- Right panel: the percentage of variance explained by each PC in our permuted
and actual data.
- If `n`, a permutation test can take a long time.

---

# Summary

--

- PCA is an important tool for _exploratory data analysis_ in sociolinguistics.
- It is well suited to 'quantitative abstraction': we move from lots of related
variables to structural variation between them.

--

- We've covered:
  1. the geometric intuition behind PCA,
  2. pre-PCA data processing,
  3. the application of PCA with `prcomp`,
  4. visual interpretation of PCA with `factoextra` and `nzilbb.vowels`,
  5. how to access loadings, scores, and variances explained, and
  6. testing for meaningful structure with permutation tests.
  
--

- For more, see:&lt;http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/&gt;




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
