{
  "hash": "9e8da393293e00d526ec297db8cb3c8a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'A 3D PCA Visualisation with Plotly'\nauthor: Joshua Wilson Black\ndate: '2022-07-19'\ncategories:\n  - data science\n  - vowels\n  - pca\n  - plotly\ndescription: 'Attempts to produce an illustrative example of PCA using formant data and Plotly via R.'\nimage: feature.png\n---\n\n\n## The Problem\n\nI am attempting to build a nice illustrative example of PCA which shows how \nit can produce interpretable, lower-dimensional representations of vowel formant\ndata. \n\nOne [well](https://towardsdatascience.com/pca-principal-component-analysis-explained-visually-in-5-minutes-20ce8a9ebf0f)-[trodden](https://towardsdatascience.com/principal-component-analysis-pca-explained-visually-with-zero-math-1cbf392b9e7d) [method](https://machinelearningmastery.com/principal-component-analysis-for-visualization/) of showing how PCA works is to start with three dimensions and go down to two dimensions.\n\nHeavy use of `ggplot2` for the last year and a half has worn deep grooves into\nmy brain. But `ggplot2` does not offer options for 3D plots.\n\nA few extension packages exist to extend `ggplot` into three dimensions, but\nnothing stood out to me as I was looking around. I have also wanted to explore\n`plotly` a little more after playing around with `plotly` cytoscapes for \n[another project](https://nz-newspaper-philosophy.herokuapp.com/).\n\nThe following example, which will be used for a larger project on PCA in the\nstudy of vowel covariation, took far more work than anticipated. I'll present \nit in the next section and then run through some of the problems which occurred\nfor me.\n\n## A Plotly Example\n\nHere's the code, with the Plotly interactive following.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(plotly)\n\n# Reorganising data\n\nload('onze_means.rda')\n\nonze_sub <- onze_means %>%\n  filter(\n    vowel %in% c(\"DRESS\", \"KIT\", \"TRAP\")\n  ) %>%\n  select(\n    speaker, vowel, F1_50, yob, gender\n  )\n\nonze_to_pca <- onze_sub %>%\n  pivot_wider(\n    names_from = vowel,\n    values_from = F1_50\n  )\n\n# Running PCA\n\nonze_pca <- prcomp(\n  onze_to_pca %>% select(DRESS, KIT, TRAP),\n  scale=FALSE\n)\n\n# Extracting PCA information\n\n# Load scores for individuals (contained in onze_pca$x)\nonze_to_pca <- onze_to_pca %>%\n  mutate(\n    PC1 = onze_pca$x[, 1],\n    PC2 = onze_pca$x[, 2]\n  )\n\n# Extract centre. This will be used in the plot.\npca_center <- onze_pca$center\n\ncenter_tibble <- tibble(\n  \"DRESS\" = pca_center[[1]],\n  \"KIT\" = pca_center[[2]],\n  \"TRAP\" = pca_center[[3]]\n)\n\n# Extract loadings.\npca_loadings <- onze_pca$rotation\n\n# Use the loadings and centre to find where each point sits along PC1 and PC2\n# when represented in the original 3D space.\nonze_to_pca <- onze_to_pca %>%\n  mutate(\n    PC1_DRESS = (PC1 * pca_loadings[1, 1]) + pca_center[[1]],\n    PC1_KIT = (PC1 * pca_loadings[2, 1]) + pca_center[[2]],\n    PC1_TRAP = (PC1 * pca_loadings[3, 1]) + pca_center[[3]],\n    PC2_DRESS = (PC2 * pca_loadings[1, 2]) + pca_center[[1]],\n    PC2_KIT = (PC2 * pca_loadings[2, 2]) + pca_center[[2]],\n    PC2_TRAP = (PC2 * pca_loadings[3, 2]) + pca_center[[3]],\n  )\n\n# Visualisation\n\nfig <- plot_ly(\n  data = onze_to_pca,\n  x = ~DRESS,\n  y = ~KIT,\n  z = ~TRAP,\n  type = \"scatter3d\", # What kind of plot.\n  mode = \"markers\", # What kind of marking (something like geom in ggplot)\n  name = \"Speakers\", # This label will go in the legend.\n  marker = list(\n    size = 2,\n    opacity = 0.8,\n    color = \"gray\",\n    lines = list(\n      color = 'black',\n      width = 1\n    ),\n    showlegend = FALSE\n  )\n)\n\n# Add title and axis labels\nfig <- fig %>%\n  layout(\n    margin = list(\n      t = 90\n    ),\n    title = list(\n      text = \"Mean KIT, DRESS, and TRAP F1 for 100 ONZE Speakers\",\n      font = list(\n        size = 24,\n        family = \"Open Sans\"\n      )\n    ),\n    scene = list(\n      xaxis = list(\n        title = \"DRESS F1 (Hz)\"\n      ),\n      yaxis = list(\n        title = \"KIT F1 (Hz)\"\n      ),\n      zaxis = list(\n        title = \"TRAP F1 (Hz)\"\n      )\n    )\n  )\n\nfig <- fig %>%\n  # Add centre mark\n  add_trace(\n    x = ~DRESS,\n    y = ~KIT,\n    z = ~TRAP,\n    data = center_tibble,\n    type = 'scatter3d',\n    mode = 'markers',\n    marker = list(\n      size = 6,\n      opacity = 1,\n      color = 'red',\n      symbol = \"x\"\n      ),\n    name = \"Center\",\n    inherit = FALSE\n  ) %>%\n  # Add PC1 line\n  add_trace(\n    data = onze_to_pca,\n    x = ~PC1_DRESS,\n    y = ~PC1_KIT,\n    z = ~PC1_TRAP,\n    type = 'scatter3d',\n    mode = 'lines',\n    name = 'PC1',\n    line = list(\n      color = \"#D55E00\",\n      width = 6\n    ),\n    inherit = FALSE\n  ) %>%\n  # Add PC2 line.\n  add_trace(\n    data = onze_to_pca,\n    x = ~PC2_DRESS,\n    y = ~PC2_KIT,\n    z = ~PC2_TRAP,\n    type = 'scatter3d',\n    mode = 'lines',\n    name = 'PC2',\n    line = list(\n      color = \"#0072B2\",\n      width = 4\n    ),\n    inherit = FALSE\n  ) %>%\n  layout(\n    scene = list(\n      xaxis = list(\n        title = \"DRESS F1 (Hz)\"\n      ),\n      yaxis = list(\n        title = \"KIT F1 (Hz)\"\n      ),\n      zaxis = list(\n        title = \"TRAP F1 (Hz)\"\n      )\n    )\n  )\n\nfig\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-04b7ce07d724def6a44e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-04b7ce07d724def6a44e\">{\"x\":{\"visdat\":{\"56913125c762\":[\"function () \",\"plotlyVisDat\"],\"569127450c23\":[\"function () \",\"data\"],\"5691261fe1f9\":[\"function () \",\"data\"],\"5691772cb5fc\":[\"function () \",\"data\"]},\"cur_data\":\"5691772cb5fc\",\"attrs\":{\"56913125c762\":{\"x\":{},\"y\":{},\"z\":{},\"mode\":\"markers\",\"marker\":{\"size\":2,\"opacity\":0.80000000000000004,\"color\":\"gray\",\"lines\":{\"color\":\"black\",\"width\":1},\"showlegend\":false},\"name\":\"Speakers\",\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\"},\"569127450c23\":{\"x\":{},\"y\":{},\"z\":{},\"type\":\"scatter3d\",\"mode\":\"markers\",\"marker\":{\"size\":6,\"opacity\":1,\"color\":\"red\",\"symbol\":\"x\"},\"name\":\"Center\",\"inherit\":false},\"5691261fe1f9\":{\"x\":{},\"y\":{},\"z\":{},\"type\":\"scatter3d\",\"mode\":\"lines\",\"name\":\"PC1\",\"line\":{\"color\":\"#D55E00\",\"width\":6},\"inherit\":false},\"5691772cb5fc\":{\"x\":{},\"y\":{},\"z\":{},\"type\":\"scatter3d\",\"mode\":\"lines\",\"name\":\"PC2\",\"line\":{\"color\":\"#0072B2\",\"width\":4},\"inherit\":false}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":90,\"r\":10},\"title\":{\"text\":\"Mean KIT, DRESS, and TRAP F1 for 100 ONZE Speakers\",\"font\":{\"size\":24,\"family\":\"Open Sans\"}},\"scene\":{\"xaxis\":{\"title\":\"DRESS F1 (Hz)\"},\"yaxis\":{\"title\":\"KIT F1 (Hz)\"},\"zaxis\":{\"title\":\"TRAP F1 (Hz)\"}},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[622.5797101449275,551.32824427480921,534.70000000000005,455.84259259259261,515.78082191780823,557.5090909090909,605.10344827586209,418.37096774193549,472.48979591836735,507.80000000000001,494.13178294573646,494.13636363636363,584.31645569620252,409.09433962264148,540.79279279279274,586.945652173913,431.28571428571428,581.79279279279274,593.76470588235293,482.75714285714287,493.54545454545456,500.82278481012656,466.89999999999998,469.5609756097561,497.8170731707317,451.1953125,474.27777777777777,562.18032786885249,516.45161290322585,451.74603174603175,380.25510204081633,541.18032786885249,439.87567567567567,386.63888888888891,466.85281385281388,483.66666666666669,455.55737704918033,521.05555555555554,473.74479166666669,433.59459459459458,359.23333333333335,530.81132075471703,511.469696969697,502.78571428571428,495.43617021276594,419.89887640449439,394.21875,364.9221105527638,417.45418326693226,516.90067720090292,532.10298102981028,609.52702702702697,498.3532338308458,476.78908188585609,603.21875,467.71882640586796,566.81200000000001,625.21951219512198,444.05050505050502,605.9655172413793,492.82482993197277,576.35420743639918,458.57602339181284,516.82575757575762,563.7117117117117,417.2823529411765,522.19395465994967,494.37068965517244,451.58755760368666,598.68589743589746,418.04166666666669,529.91327913279133,495.2641509433962,578.66141732283461,549.83127572016463,571.70192307692309,427.94029850746267,483.01249999999999,454.18181818181819,548.10298102981028,480.02459016393442,438.72463768115944,484.08653846153845,456.15909090909093,609.9045226130653,447.02064896755161,515.42168674698792,436.22413793103448,538.97814207650276,415.58620689655174,421.97674418604652,446.17460317460319,517.93193717277484,510.57727272727271,474.57894736842104,559,411.76397515527952,489.34375,447.8987341772152,460.88150289017341],\"y\":[646.82142857142856,622.24309392265195,588.84444444444443,525.05594405594411,567.83823529411768,634.79487179487182,664.02941176470586,495.58571428571429,450.16216216216219,631.92307692307691,614.05536332179929,566.15079365079362,652,465.53731343283584,619.81308411214957,673.52222222222224,547.71641791044772,602.23148148148152,656.7210884353741,541.60344827586209,541.46268656716416,508.58860759493672,469.64999999999998,485.9159663865546,504.47916666666669,481.49668874172187,589.25423728813564,559.66666666666663,535.14049586776855,464.55339805825241,404.94214876033055,539.36363636363637,487.09609609609612,391.29299363057322,484.39263803680984,504.87234042553189,465.2439024390244,555.49358974358972,479.54437869822488,489.71428571428572,396.73529411764707,532.8496240601504,533.63414634146341,520.9375,473.84438040345822,391.28491620111731,392.6543624161074,457.01168224299067,475.97719869706839,484.6875,484.59701492537312,535.66769230769228,472.04015296367112,490.62972292191438,569.02380952380952,447.387610619469,515.22488038277515,547.83333333333337,508.91389432485323,557.96296296296293,486.43364485981306,549.14773980154359,425.97326203208559,456.40441176470586,528.63617021276593,414.66244725738397,495.33578431372547,460.62459546925567,424.83447098976109,485.34193548387094,357.5,451.02908277404924,443.64583333333331,428.31034482758622,439.171875,418.57692307692309,367.55696202531647,428.38532110091745,393.04285714285714,405.04926108374383,366.22727272727275,398.88679245283021,394.95890410958901,397.30120481927713,452.44334975369458,375.44892473118279,395.25714285714287,405.74025974025972,405.89180327868854,348.2162162162162,354.04861111111109,387.40816326530614,430.47619047619048,417.1556886227545,388.51485148514854,439.57333333333332,338.1720930232558,374.92349726775956,382.22257053291537,378.08764940239041],\"z\":[637.86666666666667,669.13846153846157,629.56521739130437,579.07272727272732,623.69047619047615,657.5094339622641,662.29999999999995,486.36111111111109,531.9545454545455,668.38297872340422,628.33333333333337,565.7037037037037,691.07692307692309,551.625,624.695652173913,737.93548387096769,583.27999999999997,678.53125,628.78947368421052,570.85185185185185,591.68965517241384,604.14285714285711,561.5625,616.13793103448279,594.31428571428569,485.57999999999998,621.37209302325584,612.41935483870964,576.22727272727275,529.13793103448279,496.68627450980392,620.55555555555554,546.52112676056333,445.3692307692308,588.22340425531911,558.46511627906978,523.62162162162167,633.90909090909088,521.67499999999995,546.39534883720933,473.67073170731709,588.76666666666665,629.70588235294122,647.41176470588232,648.42702702702707,558.29090909090905,506.65873015873018,493.55284552845529,509.74820143884892,613.40559440559446,621.39007092198585,694.87234042553189,588.41358024691363,607.46198830409355,690.28571428571433,593.83941605839414,673.45121951219517,692.53731343283584,638.75091575091574,712.35106382978722,615.35714285714289,727.36986301369859,551.64444444444439,615.15999999999997,613.19375000000002,525.02459016393448,620.15189873417717,596.63846153846157,517.59748427672957,710.97014925373139,455.25,645.6908212560387,613.79999999999995,759.65454545454543,703.38461538461536,751.37142857142862,475.76315789473682,567.67857142857144,526.69230769230774,700.19500000000005,594.41935483870964,531.0140845070423,618.48214285714289,527.9655172413793,690.67256637168146,475.41311475409839,640.32608695652175,492.35294117647061,682.00523560209422,491.78947368421052,546.33076923076919,504.69565217391306,588.87647058823529,587.35433070866145,594.5272727272727,645.45714285714291,510.55345911949684,600.64285714285711,598.59124087591238,618.4341085271318],\"mode\":\"markers\",\"marker\":{\"color\":\"gray\",\"size\":2,\"opacity\":0.80000000000000004,\"lines\":{\"color\":\"black\",\"width\":1},\"showlegend\":false,\"line\":{\"color\":\"black\",\"width\":1}},\"name\":\"Speakers\",\"type\":\"scatter3d\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"line\":{\"color\":\"rgba(31,119,180,1)\"},\"frame\":null},{\"x\":[495.6165178912504],\"y\":[481.88328640309874],\"z\":[596.96153969947113],\"type\":\"scatter3d\",\"mode\":\"markers\",\"marker\":{\"color\":\"red\",\"size\":6,\"opacity\":1,\"symbol\":\"x\",\"line\":{\"color\":\"rgba(255,127,14,1)\"}},\"name\":\"Center\",\"error_y\":{\"color\":\"rgba(255,127,14,1)\"},\"error_x\":{\"color\":\"rgba(255,127,14,1)\"},\"line\":{\"color\":\"rgba(255,127,14,1)\"},\"frame\":null},{\"x\":[596.46069144656894,578.35966398476319,551.18271067723799,494.00050280679221,537.4054802343594,580.76653273787929,604.65672545951475,446.91221640367922,459.77616946253784,569.65839524822047,548.28926874434319,513.99090046392439,603.53974315802668,453.63135614478654,561.66274869746428,625.15752438812547,496.15970326426674,582.66283779932712,589.33837599445712,504.30334659285899,513.27809431592175,507.98554795548046,473.44182966753181,495.59210620478257,502.92637943123475,450.824216576092,532.6825849484228,543.84393662241007,512.78852302432085,458.15173128260949,409.63586787012582,533.85874101074921,467.55141773274164,391.74063312284636,486.15568074925397,488.72076853656893,457.78331990281151,537.72958370570518,466.8406156938608,466.69613400968882,394.50304713522291,519.57034224566189,526.66725755590687,525.32592607670767,508.02587494401757,433.85692413379854,412.24016937710223,421.87239368391073,447.03341852064068,507.09607159036352,513.49561504802364,572.82970089846287,490.57369314663958,496.54763053318663,580.85431403966402,475.76127140852077,548.27943835806855,580.39446800907081,503.01631078811778,584.40696728597356,501.78262412817338,577.94303571170531,453.80040888936685,498.2078282372716,534.18757491755525,431.13386466431751,514.03325097460106,488.13379236481109,441.53972739719592,557.95189061171322,391.86684440656819,508.91201545068958,487.78409122467525,547.95946422741781,527.28297815233293,540.42665649352637,403.89061614553805,465.87603465836804,434.3615599860488,514.56026900038557,452.30956067382755,433.41905342965418,470.0047436787284,436.6796219096446,544.08480864313617,411.53074201335556,484.93931822548353,423.6593726452802,507.04335234326288,398.86559654926333,418.54589743141548,423.87702157195588,482.1781735641826,475.33606441803909,458.27321564767129,512.85470754971425,400.02104828631775,459.52672021198356,450.21411849115293,458.16068334736423],\"y\":[606.45624127309929,584.0960156140211,550.52428550285799,479.88702060917041,533.50525261591736,587.06922409983883,616.58081405912753,421.71879164567088,437.60965164634251,573.34732563606735,546.95001245744754,504.58118802985194,615.20100419081086,430.0189547807779,563.47029177473632,641.90548091587812,482.55428408767688,589.41173251168971,597.65803459337349,492.61413858480955,503.70065755421189,497.16276730569916,454.49086165548238,481.85313061115318,490.91316903907381,426.55129117190364,527.67105317168284,541.45868719507155,503.09588942270648,435.60298079027854,375.67126386220923,529.12396047318305,447.21442718982826,353.56525424393385,470.19630046458207,473.36495715441538,435.14788167477047,533.90561810740519,446.33637239311321,446.15789395764841,356.97766830776936,511.47348061128611,520.24031045866832,518.58336172347606,497.21258329353429,405.59157003818382,378.88836131720979,390.78706207071991,421.86851279776215,496.06399585284112,503.9693612322539,577.26484413732123,475.65387763132549,483.03349120951901,587.17766047013311,457.35607142553727,546.93786896692575,586.6096119969626,491.02426137557092,591.56625821374496,489.50028644281326,583.58135409985107,430.22778588304982,485.08433585799844,529.53016947850347,402.22777069866214,504.63350367754128,472.639864632198,415.08214812975086,558.88626336191317,353.72116322703971,498.30723395558346,472.20787830306978,546.54260445602904,521.00091101065789,537.2373160611204,368.57414601621633,445.1448240312539,406.21494744346018,505.28452981447242,428.38613890509606,405.05066771786932,450.24502431384713,409.07845272307418,541.75623675405427,378.01200465869567,468.69372606254092,392.9945197914796,495.99887168990432,362.36673197018598,386.67783639185615,393.26338182846587,465.28288002994287,456.83081260920488,435.75305060386029,503.17764726358376,363.79406318844019,437.30150662282654,425.79763611656523,435.61403928894401],\"z\":[707.30664382686405,687.50024659371013,657.76284445278088,595.19327340822963,642.68760634819591,690.13387602236401,716.27485879363212,543.66861230838208,557.7445295351813,677.97919673109664,654.59679985034597,617.06704591541586,715.05264114812235,551.02078892146392,669.23024852612139,738.70711950556472,597.55590072631901,692.20883952382974,699.51330671591722,606.46678907404225,616.287083465916,610.49590526838142,572.6976859261398,596.93482809095428,604.96009236095858,547.94917757212011,637.51974831796895,649.73265531346317,615.75138771627655,555.96704657515318,502.88031075948203,638.80671471961523,566.25231486123528,483.29909479077276,586.60935947169389,589.41611437887661,555.56392569436946,643.0422448962928,565.47454533594635,565.31645145781351,486.32176681129812,623.17214909265431,630.93769301337159,629.46998936205057,610.54003162285869,529.38332904267816,505.72997386677895,516.26968832564296,543.80123335871212,609.52262779812838,616.52509769110554,681.44928369654565,591.44361038414957,597.98037616573879,690.22992754963013,575.23565149622243,654.58604330429228,689.72675759603294,605.05849650856294,694.11729038450426,603.70857932294132,687.0443661144302,551.20576879730686,599.79698769688321,639.16652937630647,526.40371931301797,617.11338643609952,588.77383684801475,537.78995975025009,665.16977574482019,483.43719694138139,611.50965895017862,588.39118897296828,654.23592313849645,631.61142309544459,645.99341963568452,496.59377602537609,564.4190872856866,529.93550864512611,617.69005692564747,549.5744618433996,528.90420479841396,568.93677839962538,532.47196439973254,649.99622084502869,504.95370853023468,585.27839859800019,518.22502568043433,609.46494166113359,491.09532935221296,512.62978963422665,518.46318017791828,582.25711551916265,574.7703840644391,556.09997646529939,615.82380774897342,492.35964079177779,557.47157867886028,547.28159972069773,555.97684204952407],\"type\":\"scatter3d\",\"mode\":\"lines\",\"name\":\"PC1\",\"line\":{\"color\":\"#D55E00\",\"width\":6},\"marker\":{\"color\":\"rgba(44,160,44,1)\",\"line\":{\"color\":\"rgba(44,160,44,1)\"}},\"error_y\":{\"color\":\"rgba(44,160,44,1)\"},\"error_x\":{\"color\":\"rgba(44,160,44,1)\"},\"frame\":null},{\"x\":[475.48728758105102,479.63998973381882,478.93884347448471,477.06148772106644,481.07808832087755,475.00616815469277,473.73733559362785,463.27784905142715,489.08638029638871,472.2830698071449,467.90102190017734,468.42974486654333,479.80087788332503,481.88193750847881,470.89681842158677,483.30624234957048,469.42730480223224,489.76352570255489,468.15375484305326,474.32336726454878,479.38735087333271,490.77621130985591,489.02022866592284,495.27885712138573,489.66957247601215,470.28907426721673,470.69451688914677,486.15046339605163,480.64229949381973,482.66051534158157,483.86639979161652,490.4692256051805,478.87906642412037,478.54122608691387,490.21541735832511,481.403258701619,481.88666501743467,486.65626893280199,479.91555069674041,477.50627860965966,479.38356219959138,485.10933399937653,490.34316979673849,495.86015997843697,507.12061661993295,503.02785129499892,490.33812152745338,468.47117591497533,472.43882589132562,500.27846551513699,503.44244687909008,512.61258160864827,496.82255165287506,493.28199823597288,502.65992636601334,500.6813660057025,509.13044409471559,510.83459382220138,490.85101182351639,509.82277804642189,497.55659688176331,511.56881836514265,497.29464087956774,507.72851071337919,494.28896771894688,490.70562222789266,499.4179103836355,500.78283454240051,490.53307522690932,527.08832825214245,492.3341629892077,516.15368237438736,508.33036081695701,548.26074089291569,531.97525679147884,548.42414711086997,494.66820578872773,502.32573094729173,500.51541249523933,539.80471849904984,522.6116124096211,498.14278840596847,520.24945352322254,499.89308181415345,532.8728576197833,494.70622932231345,527.64263730521498,489.00615632034015,535.23481142855019,501.14863748148019,510.44207839527473,496.99962239503344,509.54076096648333,511.81315592878548,516.41189945899293,522.1915851844592,506.72515497973876,522.58871027656437,515.8217954540753,521.95051294857365],\"y\":[528.1641568914564,518.61631688231364,520.22838345026366,524.54477593748652,515.3098588890623,529.27034056155117,532.18762425919476,556.23594277781353,496.89729576369587,535.53125367187852,545.60640252411179,544.3907693998683,518.2464048938441,513.46165905378621,538.71850523841317,510.18691546594505,542.09719227463654,495.34041165230076,545.0253221540662,530.84022768982743,519.19718093932431,493.01205777514463,497.04939075168124,482.65963175353113,495.55642771663008,540.11582287376291,539.18363435056347,503.64751858568985,516.31181902139372,511.67156279557622,508.8990085947475,493.71787540557136,520.36582208469997,521.14258029408245,494.30142810085937,514.56223128255033,513.45078962528123,502.48457692433999,517.98275061872141,523.52211837968844,519.20589180983666,506.04127006185672,494.00770131818234,481.32310761291018,455.43320882225532,464.84324283863475,494.01930823475954,544.29551165989858,535.17314126277711,471.16459567922755,463.89000994116799,442.80615272262185,479.11038890696074,487.25078432296107,465.68917115906299,470.23825199215122,450.81223903697611,446.8940796431429,492.84007738484468,449.22043361472026,477.422681446355,445.20595990594552,478.02496735716392,454.03554644888743,484.9355728862061,493.1743552952131,473.14317309999115,470.00495682223186,493.57107316681584,409.52370002544285,489.4300350754159,434.6644988491326,452.6517803402063,360.84435798139106,398.28773604025821,360.46865648194989,484.06363353625051,466.45754901819163,470.61981019415271,380.28633719402205,419.81650819187979,476.07491734434831,425.24755388064318,472.05066498633386,396.22398362425298,483.97621031110612,408.24923969584069,497.08174570978667,390.79340944737379,469.16390735402496,447.79654612389396,478.70327010714459,449.8688437005012,444.64418208512819,434.07080941012509,420.78222944946089,456.34244919910509,419.86916448511965,435.42756903805866,421.33649967020062],\"z\":[563.10929745190151,570.09308555960024,568.91393600165975,565.75670143430614,572.51160136943395,562.30017702751854,560.16632359314201,542.57612929582888,585.97951026443559,557.72061866862589,550.35112937364988,551.24030683664546,570.36365847907678,573.86347111357418,555.38929665597243,576.25878935336755,552.91794875732535,587.11829649585707,550.77616185995623,561.15187971143598,569.66821129592847,588.8213759465209,585.86826005838736,596.39368022333565,586.96029108105211,554.36722566660842,555.04907696661132,581.04204526466435,571.77871547588484,575.17284087131532,577.20083160400009,588.30510412285628,568.81340621693403,568.24524475423163,587.87826324893445,573.05845519002014,573.87142158042934,581.89268144381117,570.5565089656144,566.50472650422341,569.66183971095916,579.29113059956387,588.09311033579468,597.37128368024139,616.30850582792721,609.42551620999257,588.08462043170323,551.30998331540184,557.9825607603982,604.8017490804192,610.12276046281011,625.54459316699263,598.98978153624807,593.03547180296914,608.80676012081267,605.47932516247033,619.68852411494981,622.55447022972737,588.94717137285647,620.85285361429999,600.2242587877904,623.78924904186931,599.78371546308938,617.33082897665599,594.72893818733826,588.70266307643953,603.35451437099186,605.64996941621837,588.41248293609806,649.88911476758801,591.44145415352034,631.49982340170811,618.34298767269502,685.4957241925789,658.10768478794057,685.77053186230626,595.3667201000037,608.24472848332573,605.20023359506013,671.2748466867472,642.36041809915264,601.21008373862378,638.38786805042594,604.1536317802088,659.61722093080959,595.43066600604266,650.82132151645328,585.84459395470049,663.58942609115456,606.26515685844879,621.89435918159177,599.28756945789883,620.37857266262381,624.20016263703178,631.93407881862311,641.6540392084728,615.64343999892276,642.32190254022282,630.94167407100531,641.24861706353249],\"type\":\"scatter3d\",\"mode\":\"lines\",\"name\":\"PC2\",\"line\":{\"color\":\"#0072B2\",\"width\":4},\"marker\":{\"color\":\"rgba(214,39,40,1)\",\"line\":{\"color\":\"rgba(214,39,40,1)\"}},\"error_y\":{\"color\":\"rgba(214,39,40,1)\"},\"error_x\":{\"color\":\"rgba(214,39,40,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\nThe plot above can be rotated with the mouse and the legend on the right allows\nfor different plot elements to be turned off. Double click 'Speakers' to see\njust the points for each speaker.\n\nWhat are these elements?\n\n- The points are the mean first formant values for \n<span style=\"font-variant: small-caps;\">dress</span>,\n<span style=\"font-variant: small-caps;\">trap</span>, and\n<span style=\"font-variant: small-caps;\">kit</span>\nfor 100 speakers from the Origins of New Zealand English (ONZE) corpus.\n- The 'Center' is the centre of the cloud of points.\n- PC1 shows the first principal component derived from the data.\n- PC2 shows the second principal component.\n\nThe idea here is to explain PCA in three dimensions as putting a cross in the \ncentre of a cloud of points and then drawing the straight line which captures\nthe most variation in the data. That is, to draw the straight line which is \n'inside' the cloud of points for as much of its length as possible. We then\ncreate the second PC, by finding the line at right angles to the first line \nwhich captures the most possible variance.\n\nThe data can then be plotted against these two lines rather than the original\nthree dimensions and the same idea extends to cases when we have many many more\nvariables than three.\n\nIdeally, the principal components are _interpretable_. In this case, the first\nPC is a line from small values of all three variables to large values. That is,\nwe can interpret it as capturing something like vocal tract length. Speakers\nwith long vocal tracts tend to have lower first formant values. \n\nThe second formant is also interpretable. The ONZE corpus contains speakers born\nin the mid-nineteenth century all the way through to the 1980's. In this time,\n<span style=\"font-variant: small-caps;\">dress</span> and\n<span style=\"font-variant: small-caps;\">trap</span> have raised, while\n<span style=\"font-variant: small-caps;\">kit</span> has lowered. The line for\nPC2 (the blue line), runs from high values of <span style=\"font-variant: small-caps;\">dress</span> and\n<span style=\"font-variant: small-caps;\">trap</span> and low values of \n<span style=\"font-variant: small-caps;\">kit</span> to \nlow values of <span style=\"font-variant: small-caps;\">dress</span> and\n<span style=\"font-variant: small-caps;\">trap</span> and high values of \n<span style=\"font-variant: small-caps;\">kit</span>. That is, it captures the\nstructure in our data which comes from the structured change in vowel spaces\nwhich has occurred over time in New Zealand English.\n\n## Lessons Learned\n\nI have not found the `plotly` documentation for R to be very easy to get my head\ninto.\n\nA few things which caused me trouble and might help you:\n\n- `plotly` is not 'surly'. Surliness is a feature of the `tidyverse` packages: they complain. If you add an argument to a `plotly` function which it doesn't \nrecognise, it will often just ignore it without telling you. This is not great\nfor people who like to use 'colour' rather than 'color' or 'grey' rather than 'gray'.\n- Often an initial plot is made with `plot_ly()` and then additional features are \nadded to the plot with `add_trace()`. In this case, the points are added to the\nplot at the `plot_ly()` stage, and the lines and the red cross added using `add_trace()`.\nThe first argument to `plot_ly()` is a data frame, but this is not the case for\n`add_trace()`. I have found being explicit by saying `data = onze_to_pca` rather\nthan just having `plot_ly(onze_to_pca ...)`, avoids confusion. It took me a long\ntime to work out why my `add_trace(onze_to_pca)` was not functioning.\n- If the added element is different in `type` from the original plot, it is \nvital to add `inherit = FALSE` to any `add_trace()` calls. My initial attempts\nto add lines to the plot added both lines _and_ points ('markers' in `plotly` speak)\nbecause I failed to add `inherit = FALSE`.\n- Axis labelling for 3D plots occurs by modifying the `scene` rather than `xaxis`\nor `yaxis` etc. directly. See the call to `layout()` in the plot code.\n\nIt may be that there are obvious solutions to some of these problems. If so,\nplease let me know!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}